module.exports=[253331,a=>{"use strict";let b;a.s([],713593),a.i(713593);var c=a.i(943478),d=a.i(497474);a.s([],571426),a.i(571426);var e=a.i(408811),f=a.i(320358),g=a.i(123908),h=a.i(346821),i=a.i(94293),j=a.i(777514),k=a.i(797228),l=a.i(856246),m=a.i(542042),n=a.i(958678),o=a.i(440154),p=a.i(729992),q=a.i(292206),r=a.i(542355),s=a.i(93782),t=a.i(493847);a.s(["arbitrum",()=>e.arbitrum,"arbitrumSepolia",()=>f.arbitrumSepolia,"base",()=>g.base,"baseSepolia",()=>h.baseSepolia,"berachain",()=>i.berachain,"berachainBepolia",()=>j.berachainBepolia,"bsc",()=>k.bsc,"celo",()=>l.celo,"gnosis",()=>m.gnosis,"hoodi",()=>n.hoodi,"katana",()=>o.katana,"mainnet",()=>p.mainnet,"optimism",()=>q.optimism,"optimismSepolia",()=>r.optimismSepolia,"polygon",()=>s.polygon,"sepolia",()=>t.sepolia],875320);var u=a.i(875320);let v=[u.base,...Object.values(u).filter(a=>a&&a.id!==u.base.id)],w=d.anvil,x=(0,c.defineChain)({...w,id:31338}),y=(0,c.defineChain)({...w,id:31339});a.s(["all",0,v,"anvil",0,w,"anvil2",0,x,"anvil3",0,y],664470),a.i(664470),a.s(["all",0,v,"anvil",0,w,"anvil2",0,x,"anvil3",0,y,"arbitrum",()=>e.arbitrum,"arbitrumSepolia",()=>f.arbitrumSepolia,"base",()=>g.base,"baseSepolia",()=>h.baseSepolia,"berachain",()=>i.berachain,"berachainBepolia",()=>j.berachainBepolia,"bsc",()=>k.bsc,"celo",()=>l.celo,"gnosis",()=>m.gnosis,"hoodi",()=>n.hoodi,"katana",()=>o.katana,"mainnet",()=>p.mainnet,"optimism",()=>q.optimism,"optimismSepolia",()=>r.optimismSepolia,"polygon",()=>s.polygon,"sepolia",()=>t.sepolia],376801);var z=a.i(376801),A=a.i(168810);a.i(78006);var B=a.i(977988),C=a.i(610888);function D(a){if(a instanceof Error&&!("code"in a))return new P({cause:a,data:a,message:a.message,stack:a.stack});let{code:b}=a;return b===P.code?new P(a):b===F.code?new F(a):b===O.code?new O(a):b===M.code?new M(a):b===K.code?new K(a):b===N.code?new N(a):b===J.code?new J(a):b===Q.code?new Q(a):b===G.code?new G(a):b===H.code?new H(a):b===I.code?new I(a):b===L.code?new L(a):new P({cause:a instanceof Error?a:void 0,data:a,message:a.message,stack:a instanceof Error?a.stack:void 0})}class E extends Error{constructor(a){const{cause:b,code:c,message:d,data:e,stack:f}=a;super(d,{cause:b}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.BaseError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stack",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=b,this.code=c,this.data=e,this.stack=f??""}}class F extends E{constructor(a={}){super({code:F.code,data:a.data,message:a.message??"Missing or invalid parameters."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.InvalidInputError"})}}Object.defineProperty(F,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class G extends E{constructor(a={}){super({code:G.code,data:a.data,message:a.message??"Requested resource not found."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.ResourceNotFoundError"})}}Object.defineProperty(G,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class H extends E{constructor(a={}){super({code:H.code,data:a.data,message:a.message??"Requested resource not available."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.ResourceUnavailableError"})}}Object.defineProperty(H,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class I extends E{constructor(a={}){super({code:I.code,data:a.data,message:a.message??"Transaction creation failed."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.TransactionRejectedError"})}}Object.defineProperty(I,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class J extends E{constructor(a={}){super({code:J.code,data:a.data,message:a.message??"Method is not implemented."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.MethodNotSupportedError"})}}Object.defineProperty(J,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class K extends E{constructor(a={}){super({code:K.code,data:a.data,message:a.message??"Rate limit exceeded."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.LimitExceededError"})}}Object.defineProperty(K,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class L extends E{constructor(a={}){super({code:L.code,data:a.data,message:a.message??"JSON-RPC version not supported."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.VersionNotSupportedError"})}}Object.defineProperty(L,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class M extends E{constructor(a={}){super({code:M.code,data:a.data,message:a.message??"Input is not a valid JSON-RPC request."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.InvalidRequestError"})}}Object.defineProperty(M,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class N extends E{constructor(a={}){super({code:N.code,data:a.data,message:a.message??"Method does not exist."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.MethodNotFoundError"})}}Object.defineProperty(N,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class O extends E{constructor(a={}){super({code:O.code,data:a.data,message:a.message??"Invalid method parameters."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.InvalidParamsError"})}}Object.defineProperty(O,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class P extends E{constructor(a={}){super({cause:a.cause,code:P.code,data:a.data,message:a.message??"Internal JSON-RPC error.",stack:a.stack}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.InternalError"})}}Object.defineProperty(P,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class Q extends E{constructor(a={}){super({code:Q.code,data:a.data,message:a.message??"Failed to parse JSON-RPC response."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.ParseError"})}}Object.defineProperty(Q,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class R extends Error{constructor(a,b){super(b),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderRpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=a,this.details=b}}class S extends R{constructor({message:a="The user rejected the request."}={}){super(4001,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UserRejectedRequestError"})}}Object.defineProperty(S,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class T extends R{constructor({message:a="The requested method and/or account has not been authorized by the user."}={}){super(4100,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnauthorizedError"})}}Object.defineProperty(T,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class U extends R{constructor({message:a="The provider does not support the requested method."}={}){super(4200,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnsupportedMethodError"})}}Object.defineProperty(U,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class V extends R{constructor({message:a="The provider is disconnected from all chains."}={}){super(4900,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.DisconnectedError"})}}Object.defineProperty(V,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class W extends R{constructor({message:a="The provider is not connected to the requested chain."}={}){super(4901,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.ChainDisconnectedError"})}}Object.defineProperty(W,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class X extends R{constructor({message:a="An error occurred when attempting to switch chain."}={}){super(4902,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.SwitchChainError"})}}Object.defineProperty(X,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class Y extends R{constructor({message:a="This Wallet does not support a capability that was not marked as optional."}={}){super(5700,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnsupportedNonOptionalCapabilityError"})}}Object.defineProperty(Y,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class Z extends R{constructor({message:a="This Wallet does not support the requested chain ID."}={}){super(5710,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnsupportedChainIdError"})}}Object.defineProperty(Z,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class $ extends R{constructor({message:a="There is already a bundle submitted with this ID."}={}){super(5720,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.DuplicateIdError"})}}Object.defineProperty($,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class _ extends R{constructor({message:a="This bundle id is unknown / has not been submitted."}={}){super(5730,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnknownBundleIdError"})}}Object.defineProperty(_,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class aa extends R{constructor({message:a="The call bundle is too large for the Wallet to process."}={}){super(5740,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.BundleTooLargeError"})}}Object.defineProperty(aa,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class ab extends R{constructor({message:a="The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."}={}){super(5750,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.AtomicReadyWalletRejectedUpgradeError"})}}Object.defineProperty(ab,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class ac extends R{constructor({message:a="The wallet does not support atomic execution but the request requires it."}={}){super(5760,a),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.AtomicityNotSupportedError"})}}function ad(a,b={}){let{includeEvents:c=!0}=b;if(!a)throw new af;return{...c?{on:a.on?.bind(a),removeListener:a.removeListener?.bind(a)}:{},async request(b){try{let c=await a.request(b);if(c&&"object"==typeof c&&"jsonrpc"in c)return function(a,b={}){let{raw:c=!1}=b;if(c)return a;if(a.error)throw D(a.error);return a.result}(c);return c}catch(a){throw ae(a)}}}}function ae(a){let b=D(a);if(b instanceof P){if(!b.data)return b;let{code:a}=b.data;if(a===V.code)return new V(b);if(a===W.code)return new W(b);if(a===S.code)return new S(b);if(a===T.code)return new T(b);if(a===U.code)return new U(b);if(a===X.code)return new X(b);if(a===ab.code)return new ab(b);if(a===ac.code)return new ac(b);if(a===aa.code)return new aa(b);if(a===_.code)return new _(b);if(a===$.code)return new $(b);if(a===Z.code)return new Z(b);if(a===Y.code)return new Y(b)}return b}Object.defineProperty(ac,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class af extends C.BaseError{constructor(){super("`provider` is undefined."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.IsUndefinedError"})}}let ag={get environment(){if(!b)throw Error("React Native environment is not configured");return b},set environment(env){b=env}};function ah(){return"undefined"!=typeof navigator&&"ReactNative"===navigator.product||!!("undefined"!=typeof globalThis&&Object.hasOwn(globalThis,"HermesEngine"))}let ai={local:"http://localhost:5175/dialog/",prod:"https://id.porto.sh/dialog",stg:"https://stg.id.porto.sh/dialog"};function aj(a){return a}function ak(a={}){let{skipProtocolCheck:b,skipUnsupported:c}=a;return an()}function al(a={}){return an()}function am(a={}){if(!ah())return an();let{requestOptions:b={showTitle:!0}}=a;return{name:"authSession",setup(c){let{host:d,internal:e}=c,{store:f}=e,g=ag.environment;g.maybeCompleteAuthSession?.();let h=!1,i=null;async function j(c){let{request:e}=c,h={account_verifyEmail:"account_verifyEmail",eth_requestAccounts:"eth_requestAccounts",eth_sendTransaction:"eth_sendTransaction",eth_signTypedData_v4:"eth_signTypedData_v4",personal_sign:"personal_sign",wallet_addFunds:"wallet_addFunds",wallet_connect:"wallet_connect",wallet_getAccountVersion:"wallet_getAccountVersion",wallet_getAssets:"wallet_getAssets",wallet_getCallsStatus:"wallet_getCallsStatus",wallet_getCapabilities:"wallet_getCapabilities",wallet_getKeys:"wallet_getKeys",wallet_getPermissions:"wallet_getPermissions",wallet_grantAdmin:"wallet_grantAdmin",wallet_grantPermissions:"wallet_grantPermissions",wallet_prepareCalls:"wallet_prepareCalls",wallet_prepareUpgradeAccount:"wallet_prepareUpgradeAccount",wallet_revokeAdmin:"wallet_revokeAdmin",wallet_revokePermissions:"wallet_revokePermissions",wallet_sendCalls:"wallet_sendCalls",wallet_sendPreparedCalls:"wallet_sendPreparedCalls",wallet_switchEthereumChain:"wallet_switchEthereumChain",wallet_verifySignature:"wallet_verifySignature"}[e.method];if(!h)throw new U({message:`Method not supported in Mode.reactNative(): ${e.method}`});let i=g.makeRedirectUri({...a.redirectUri?{scheme:a.redirectUri.scheme}:{},path:a.redirectUri?.path??"/",preferLocalhost:"boolean"==typeof __DEV__&&__DEV__}),j=new URL(d);j.pathname=`${j.pathname.replace(/\/$/,"")}/${h}`;let k=new URLSearchParams({id:String(e.id),jsonrpc:"2.0",method:e.method,redirectUri:i}),l=e.params??[];l.length>0&&k.set("params",A.stringify(l));let m=e._decoded?.params;m&&k.set("_decoded",A.stringify(m)),j.search=k.toString();let n=await g.openAuthSessionAsync(j.toString(),i,b);at(f,(()=>{if("success"===n.type&&n.url){let a=new URL(n.url),b=a.searchParams.get("status")??"unknown",c=a.searchParams.get("message")??void 0,d=a.searchParams.get("payload")??void 0;if("success"===b)try{return{id:e.id,jsonrpc:"2.0",result:d?A.parse(d):void 0}}catch(a){return{error:{code:-32603,message:a instanceof Error?a.message:"Failed to parse redirect payload"},id:e.id,jsonrpc:"2.0"}}let f="cancel"===b?new S({message:c??"User rejected request"}):new R(-32603,c??b??"Request failed");return{error:{code:f.code,message:f.message},id:e.id,jsonrpc:"2.0"}}return"cancel"===n.type||"dismiss"===n.type?{error:{code:S.code,message:"User rejected request"},id:e.id,jsonrpc:"2.0"}:{error:{code:-32603,message:n.error??"Request failed"},id:e.id,jsonrpc:"2.0"}})()),g.dismissAuthSession?.()}return{close(){g.dismissAuthSession?.()},destroy(){g.dismissAuthSession?.()},open(){},secure:async()=>({frame:!1,host:!0,protocol:!0}),async syncRequests(a){if(h)return;let[b]=a;if(b&&i!==b.request.id){i=b.request.id,h=!0;try{await j(b)}catch(a){at(f,{error:{code:-32603,message:a instanceof Error?a.message:"Request failed"},id:b.request.id,jsonrpc:"2.0"}),g.dismissAuthSession?.()}finally{i=null,h=!1}}}}},supportsHeadless:!1}}function an(){return{name:"noop",setup:()=>({close(){},destroy(){},open(){},secure:async()=>({frame:!0,host:!0,protocol:!0}),async syncRequests(){}}),supportsHeadless:!0}}function ao(a){let{element:b}=a;return an()}function ap(){let a=null,b=null;return{_setup(c,d=!1){d&&(a=null),b=c},getTheme:()=>a,setTheme(c){a=c,b?.send("__internal",{theme:c,type:"set-theme"}).catch(()=>{})}}}function aq(a,b={}){let{methodPolicies:c,targetOrigin:d}=b,e=c?.find(b=>b.method===a.method);return!e||!e.modes?.headless||"object"==typeof e.modes.headless&&!!e.modes.headless.sameOrigin&&d!==window.location.origin}function ar(){let a,b;return{icon:(a=document.querySelector('link[rel="icon"][media="(prefers-color-scheme: dark)"]')?.href,b=document.querySelector('link[rel="icon"][media="(prefers-color-scheme: light)"]')?.href??document.querySelector('link[rel="icon"]')?.href,a&&b&&a!==b?{dark:a,light:b}:window.matchMedia("(prefers-color-scheme: dark)").matches?a:b),title:document.title}}function as(a){a.setState(a=>({...a,requestQueue:a.requestQueue.map(a=>({account:a.account,error:new S,request:a.request,status:"error"}))}))}function at(a,b){a.setState(a=>({...a,requestQueue:a.requestQueue.map(a=>a.request.id!==b.id?a:b.error?{account:a.account,error:b.error,request:a.request,status:"error"}:{account:a.account,request:a.request,result:b.result,status:"success"})}))}function au(a){let b=new URL(a),c=new URLSearchParams(window.location.search),d="porto.";for(let[a,e]of c.entries())a.startsWith(d)&&b.searchParams.set(a.slice(d.length),e);return b.toString()}a.s(["authSession",()=>am,"createThemeController",()=>ap,"defaultSize",0,{height:282,width:360},"experimental_inline",()=>ao,"from",()=>aj,"getDialogUrl",()=>au,"getReferrer",()=>ar,"handleBlur",()=>as,"handleResponse",()=>at,"hostUrls",0,ai,"iframe",()=>ak,"noop",()=>an,"popup",()=>al,"requiresConfirmation",()=>aq],330924);var av=a.i(330924),aw=a.i(322009),ax=a.i(876139),ay=a.i(243978),az=a.i(405114);a.i(826483);var aA=a.i(883876),aB=a.i(641128),aC=a.i(559952),aD=a.i(294418),aE=a.i(66874),aF=C,aG=a.i(784414),aH=a.i(591830);function aI(a){return["string"==typeof a?.name&&{name:"name",type:"string"},a?.version&&{name:"version",type:"string"},("number"==typeof a?.chainId||"bigint"==typeof a?.chainId)&&{name:"chainId",type:"uint256"},a?.verifyingContract&&{name:"verifyingContract",type:"address"},a?.salt&&{name:"salt",type:"bytes32"}].filter(Boolean)}function aJ(a){return aG.keccak256(function(a){let{domain:b={},message:c,primaryType:d}=a,e={EIP712Domain:aI(b),...a.types};!function(a){let{domain:b,message:c,primaryType:d,types:e}=a,f=(a,b)=>{for(let c of a){let{name:a,type:d}=c,g=b[a],h=d.match(aH.integerRegex);if(h&&("number"==typeof g||"bigint"==typeof g)){let[,a,b]=h;ax.fromNumber(g,{signed:"int"===a,size:Number.parseInt(b??"",10)/8})}if("address"===d&&"string"==typeof g&&!aw.validate(g))throw new aw.InvalidAddressError({address:g,cause:new aw.InvalidInputError});let i=d.match(aH.bytesRegex);if(i){let[,a]=i;if(a&&ax.size(g)!==Number.parseInt(a,10))throw new aL({expectedSize:Number.parseInt(a,10),givenSize:ax.size(g)})}let j=e[d];j&&(function(a){if("address"===a||"bool"===a||"string"===a||a.startsWith("bytes")||a.startsWith("uint")||a.startsWith("int"))throw new aO({type:a})}(d),f(j,g))}};if(e.EIP712Domain&&b){if("object"!=typeof b)throw new aM({domain:b});f(e.EIP712Domain,b)}if("EIP712Domain"!==d)if(e[d])f(e[d],c);else throw new aN({primaryType:d,types:e})}({domain:b,message:c,primaryType:d,types:e});let f=["0x19","0x01"];return b&&f.push(function(a){let{domain:b,types:c}=a;return aK({data:b,primaryType:"EIP712Domain",types:{...c,EIP712Domain:c?.EIP712Domain||aI(b)}})}({domain:b,types:e})),"EIP712Domain"!==d&&f.push(aK({data:c,primaryType:d,types:e})),ax.concat(...f)}(a))}function aK(a){let{data:b,primaryType:c,types:d}=a,e=function a(b){let{data:c,primaryType:d,types:e}=b,f=[{type:"bytes32"}],g=[function(a){let{primaryType:b,types:c}=a,d=ax.fromString(function(a){let{primaryType:b,types:c}=a,d="",e=function a(b,c=new Set){let{primaryType:d,types:e}=b,f=d.match(/^\w*/u),g=f?.[0];if(c.has(g)||void 0===e[g])return c;for(let b of(c.add(g),e[g]))a({primaryType:b.type,types:e},c);return c}({primaryType:b,types:c});for(let a of(e.delete(b),[b,...Array.from(e).sort()]))d+=`${a}(${(c[a]??[]).map(({name:a,type:b})=>`${b} ${a}`).join(",")})`;return d}({primaryType:b,types:c}));return aG.keccak256(d)}({primaryType:d,types:e})];for(let b of e[d]??[]){let[d,h]=function b(c){let{types:d,name:e,type:f,value:g}=c;if(void 0!==d[f])return[{type:"bytes32"},aG.keccak256(a({data:g,primaryType:f,types:d}))];if("bytes"===f){let a=g.length%2?"0":"";return g=`0x${a+g.slice(2)}`,[{type:"bytes32"},aG.keccak256(g,{as:"Hex"})]}if("string"===f)return[{type:"bytes32"},aG.keccak256(aE.fromString(g),{as:"Hex"})];if(f.lastIndexOf("]")===f.length-1){let a=f.slice(0,f.lastIndexOf("[")),c=g.map(c=>b({name:e,type:a,types:d,value:c}));return[{type:"bytes32"},aG.keccak256(aD.encode(c.map(([a])=>a),c.map(([,a])=>a)))]}return[{type:f},g]}({types:e,name:b.name,type:b.type,value:c[b.name]});f.push(d),g.push(h)}return aD.encode(f,g)}({data:b,primaryType:c,types:d});return aG.keccak256(e)}class aL extends aF.BaseError{constructor({expectedSize:a,givenSize:b}){super(`Expected bytes${a}, got bytes${b}.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.BytesSizeMismatchError"})}}class aM extends aF.BaseError{constructor({domain:a}){super(`Invalid domain "${A.stringify(a)}".`,{metaMessages:["Must be a valid EIP-712 domain."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.InvalidDomainError"})}}class aN extends aF.BaseError{constructor({primaryType:a,types:b}){super(`Invalid primary type \`${a}\` must be one of \`${JSON.stringify(Object.keys(b))}\`.`,{metaMessages:["Check that the primary type is a key in `types`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.InvalidPrimaryTypeError"})}}class aO extends aF.BaseError{constructor({type:a}){super(`Struct type "${a}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.InvalidStructTypeError"})}}var aP=a.i(14400),aQ=a.i(841767),aR=a.i(275375);a.s(["createHeadlessWebAuthnP256",()=>bs,"createP256",()=>bp,"createSecp256k1",()=>bq,"createWebAuthnP256",()=>br,"createWebCryptoP256",()=>bt,"deserialize",()=>bu,"from",()=>bv,"fromHeadlessWebAuthnP256",()=>bA,"fromP256",()=>bw,"fromRelay",()=>bx,"fromRelayKeyRole",()=>bi,"fromRelayKeyType",()=>bh,"fromSecp256k1",()=>by,"fromSerializedKeyType",()=>bj,"fromSerializedSpendPeriod",()=>bk,"fromWebAuthnP256",()=>bz,"fromWebCryptoP256",()=>bB,"getFeeToken",()=>bI,"hash",()=>bC,"resolvePermissions",()=>bH,"serialize",()=>bE,"serializePublicKey",()=>bD,"serializeWebAuthnSignature",()=>bJ,"sign",()=>bF,"toRelay",()=>bG,"toRelayKeyRole",()=>bm,"toRelayKeyType",()=>bl,"toSerializedKeyType",()=>bn,"toSerializedSpendPeriod",()=>bo,"wrapSignature",()=>bK],188986);var aS=a.i(97913),aT=a.i(910065),aU=a.i(509968),aV=a.i(529812);function aW(a){let{privateKey:b}=a,c=aT.secp256r1.ProjectivePoint.fromPrivateKey("string"==typeof b?b.slice(2):ax.fromBytes(b).slice(2));return aV.from(c)}function aX(a={}){let{as:b="Hex"}=a,c=aT.secp256r1.utils.randomPrivateKey();return"Hex"===b?ax.fromBytes(c):c}function aY(a){let{extraEntropy:b=aU.extraEntropy,hash:c,payload:d,privateKey:e}=a,{r:f,s:g,recovery:h}=aT.secp256r1.sign(d instanceof Uint8Array?d:aE.fromHex(d),e instanceof Uint8Array?e:aE.fromHex(e),{extraEntropy:"boolean"==typeof b?b:ax.from(b).slice(2),lowS:!0,...c?{prehash:!0}:{}});return{r:f,s:g,yParity:h}}aT.secp256r1;var aZ=C;function a$(a,b=0){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(a))throw new a_({value:a});let[c="",d="0"]=a.split("."),e=c.startsWith("-");if(e&&(c=c.slice(1)),d=d.replace(/(0+)$/,""),0===b)1===Math.round(Number(`.${d}`))&&(c=`${BigInt(c)+1n}`),d="";else if(d.length>b){let[a,e,f]=[d.slice(0,b-1),d.slice(b-1,b),d.slice(b)],g=Math.round(Number(`${e}.${f}`));(d=g>9?`${BigInt(a)+BigInt(1)}0`.padStart(a.length+1,"0"):`${a}${g}`).length>b&&(d=d.slice(1),c=`${BigInt(c)+1n}`),d=d.slice(0,b)}else d=d.padEnd(b,"0");return BigInt(`${e?"-":""}${c}${d}`)}class a_ extends aZ.BaseError{constructor({value:a}){super(`Value \`${a}\` is not a valid decimal number.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Value.InvalidDecimalNumberError"})}}let a0=new TextEncoder,a1=new TextDecoder,a2=Object.fromEntries(Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((a,b)=>[b,a.charCodeAt(0)])),a3={...Object.fromEntries(Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((a,b)=>[a.charCodeAt(0),b])),61:0,45:62,95:63};function a4(a){let b=a.replace(/=+$/,""),c=b.length,d=new Uint8Array(c+3);a0.encodeInto(b+"===",d);for(let a=0,c=0;a<b.length;a+=4,c+=3){let b=(a3[d[a]]<<18)+(a3[d[a+1]]<<12)+(a3[d[a+2]]<<6)+a3[d[a+3]];d[c]=b>>16,d[c+1]=b>>8&255,d[c+2]=255&b}return new Uint8Array(d.buffer,0,(c>>2)*3+(c%4&&c%4-1))}var a5=C;async function a6(a){try{let b=a.getPublicKey();if(!b)throw new ba;let c=new Uint8Array(b),d=await crypto.subtle.importKey("spki",new Uint8Array(c),{name:"ECDSA",namedCurve:"P-256",hash:"SHA-256"},!0,["verify"]),e=new Uint8Array(await crypto.subtle.exportKey("raw",d));return aV.from(e)}catch(f){if("Permission denied to access object"!==f.message)throw f;let b=new Uint8Array(a.attestationObject),c=a=>{let c=new Uint8Array([a,88,32]);for(let a=0;a<b.length-c.length;a++)if(c.every((c,d)=>b[a+d]===c))return a+c.length;throw new ba},d=c(33),e=c(34);return aV.from(new Uint8Array([4,...b.slice(d,d+32),...b.slice(e,e+32)]))}}let a7=Uint8Array.from([105,171,180,181,160,222,75,198,42,42,32,31,141,37,186,233]);async function a8(a){let{createFn:b=window.navigator.credentials.create.bind(window.navigator.credentials),...c}=a,d=function(a){let{attestation:b="none",authenticatorSelection:c={residentKey:"preferred",requireResidentKey:!1,userVerification:"required"},challenge:d=a7,excludeCredentialIds:e,extensions:f,name:g,rp:h={id:window.location.hostname,name:window.document.title},user:i}=a,j=i?.name??g;return{publicKey:{attestation:b,authenticatorSelection:c,challenge:d,...e?{excludeCredentials:e?.map(a=>({id:a4(a),type:"public-key"}))}:{},pubKeyCredParams:[{type:"public-key",alg:-7}],...f&&{extensions:f},rp:h,user:{id:i?.id??aG.keccak256(aE.fromString(j),{as:"Bytes"}),name:j,displayName:i?.displayName??j}}}}(c);try{let a=await b(d);if(!a)throw new ba;let c=a.response,e=await a6(c);return{id:a.id,publicKey:e,raw:a}}catch(a){throw new ba({cause:a})}}async function a9(a){let{getFn:b=window.navigator.credentials.get.bind(window.navigator.credentials),...c}=a,d=function(a){let{credentialId:b,challenge:c,extensions:d,rpId:e=window.location.hostname,userVerification:f="required"}=a;return{publicKey:{...b?{allowCredentials:Array.isArray(b)?b.map(a=>({id:a4(a),type:"public-key"})):[{id:a4(b),type:"public-key"}]}:{},challenge:aE.fromHex(c),...d&&{extensions:d},rpId:e,userVerification:f}}}(c);try{var e;let a,c,f,g,h,i=await b(d);if(!i)throw new bb;let j=i.response,k=String.fromCharCode(...new Uint8Array(j.clientDataJSON)),l=k.indexOf('"challenge"'),m=k.indexOf('"type"'),n=(e=new Uint8Array(j.signature),c=(a=0===e[4]?5:4)+32,f=0===e[c+2]?c+3:c+2,g=BigInt(ax.fromBytes(e.slice(a,c))),h=BigInt(ax.fromBytes(e.slice(f))),{r:g,s:h>aT.p256.CURVE.n/2n?aT.p256.CURVE.n-h:h});return{metadata:{authenticatorData:ax.fromBytes(new Uint8Array(j.authenticatorData)),clientDataJSON:k,challengeIndex:l,typeIndex:m,userVerificationRequired:"required"===d.publicKey.userVerification},signature:n,raw:i}}catch(a){throw new bb({cause:a})}}class ba extends a5.BaseError{constructor({cause:a}={}){super("Failed to create credential.",{cause:a}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WebAuthnP256.CredentialCreationFailedError"})}}class bb extends a5.BaseError{constructor({cause:a}={}){super("Failed to request credential.",{cause:a}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WebAuthnP256.CredentialRequestFailedError"})}}async function bc(a={}){let{extractable:b=!1}=a,c=await globalThis.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},b,["sign","verify"]),d=await globalThis.crypto.subtle.exportKey("raw",c.publicKey),e=aV.from(new Uint8Array(d));return{privateKey:c.privateKey,publicKey:e}}async function bd(a){let{payload:b,privateKey:c}=a,d=await globalThis.crypto.subtle.sign({name:"ECDSA",hash:"SHA-256"},c,aE.from(b)),e=aE.fromArray(new Uint8Array(d)),f=aE.toBigInt(aE.slice(e,0,32)),g=aE.toBigInt(aE.slice(e,32,64));return g>aT.p256.CURVE.n/2n&&(g=aT.p256.CURVE.n-g),{r:f,s:g}}var be=a.i(420352);let bf="0x3232323232323232323232323232323232323232",bg="0x32323232",bh={p256:"p256",secp256k1:"secp256k1",webauthnp256:"webauthn-p256"},bi={admin:"admin",normal:"session"},bj={0:"p256",1:"webauthn-p256",2:"secp256k1"},bk={0:"minute",1:"hour",2:"day",3:"week",4:"month",5:"year"},bl={address:"secp256k1",p256:"p256",secp256k1:"secp256k1","webauthn-p256":"webauthnp256"},bm={admin:"admin",session:"normal"},bn={address:2,p256:0,secp256k1:2,"webauthn-p256":1},bo={day:2,hour:1,minute:0,month:4,week:3,year:5};function bp(a={}){let b=aX();return bw({...a,privateKey:b})}function bq(a={}){let b=aB.randomPrivateKey();return by({...a,privateKey:b})}async function br(a){let{createFn:b,label:c,rpId:d,userId:e}=a,f=await a8({authenticatorSelection:{requireResidentKey:!0,residentKey:"required",userVerification:"required"},createFn:b,extensions:{credProps:!0},rp:d?{id:d,name:d}:void 0,user:{displayName:c,id:new Uint8Array(e??aE.fromString(c)),name:c}});return bz({...a,credential:{id:f.id,publicKey:f.publicKey},id:e?aE.toHex(e):aV.toHex(f.publicKey,{includePrefix:!1})})}function bs(a={}){let b=aX();return bA({...a,privateKey:b})}async function bt(a={}){let b=await bc();return bB({...a,keyPair:b})}function bu(a,b={}){let{chainId:c}=b,d=a.publicKey,e=bj[a.keyType];return bv({chainId:c,expiry:a.expiry,publicKey:d,role:a.isSuperAdmin?"admin":"session",type:e})}function bv(a,b={}){let c,{chainId:d=a.chainId}=b,{expiry:e=0,id:f,prehash:g=!1,role:h="admin",type:i}=a,j="0x"===(c=a.publicKey)?c:"secp256k1"===i||"address"===i?20===ax.size(c)||0n===ax.toBigInt(ax.slice(c,0,12))?ax.slice(c,-20):aw.fromPublicKey(aV.fromHex(c)):c;return{...a,chainId:d,expiry:e,hash:bC({publicKey:j,type:i}),id:(f??j).toLowerCase(),prehash:g,publicKey:j.toLowerCase(),role:h,type:i}}function bw(a){let{chainId:b,expiry:c,feeToken:d,permissions:e,privateKey:f,role:g}=a;return bv({chainId:b,expiry:c,feeToken:d,permissions:e,privateKey:()=>f,publicKey:aV.toHex(aW({privateKey:f}),{includePrefix:!1}),role:g,type:"p256"})}function bx(a,b){let{chainId:c}=b,{publicKey:d}=a,e=20===ax.size(d)||0n===ax.toBigInt(ax.slice(d,0,12)),f={};for(let b of a.permissions)"call"===b.type&&(f.calls??=[],f.calls.push({signature:b.selector,to:b.to===bf?void 0:b.to})),"spend"===b.type&&(f.spend??=[],f.spend.push({limit:b.limit,period:b.period,token:b.token}));return bv({chainId:c,expiry:a.expiry,permissions:f,publicKey:a.publicKey,role:bi[a.role],type:e?"address":bh[a.type]})}function by(a){let{privateKey:b,role:c}=a,d=a.publicKey?a.publicKey:b?aw.fromPublicKey(aB.getPublicKey({privateKey:b})):a.address.toLowerCase();return bv({expiry:a.expiry??0,feeToken:a.feeToken,permissions:a.permissions,privateKey:b?()=>b:void 0,publicKey:d,role:c,type:"secp256k1"})}function bz(a){let{credential:b,id:c,rpId:d}=a,e=aV.toHex(b.publicKey,{includePrefix:!1});return bv({chainId:a.chainId,expiry:a.expiry??0,feeToken:a.feeToken,id:c,permissions:a.permissions,privateKey:{credential:b,rpId:d},publicKey:e,role:a.role,type:"webauthn-p256"})}function bA(a){let{privateKey:b}=a,c=aV.toHex(aW({privateKey:b}),{includePrefix:!1});return bv({chainId:a.chainId,expiry:a.expiry??0,feeToken:a.feeToken,permissions:a.permissions,privateKey:{privateKey:()=>b},publicKey:c,role:a.role,type:"webauthn-p256"})}function bB(a){let{chainId:b,expiry:c,feeToken:d,keyPair:e,permissions:f,role:g}=a,{privateKey:h}=e;return bv({chainId:b,expiry:c,feeToken:d,permissions:f,prehash:!0,privateKey:h,publicKey:aV.toHex(e.publicKey,{includePrefix:!1}),role:g,type:"p256"})}function bC(a){let{type:b}=a,c=bD(a.publicKey);return aG.keccak256(aD.encode([{type:"uint8"},{type:"bytes32"}],[bn[b],aG.keccak256(c)]))}function bD(a){return 32>ax.size(a)?ax.padLeft(a,32):a}function bE(a){let{expiry:b=0,publicKey:c,role:d,type:e}=a;return{expiry:b,isSuperAdmin:"admin"===d,keyType:bn[e],publicKey:bD(c)}}async function bF(a,b){let{address:c,storage:d,webAuthn:e,wrap:f=!0}=b,{privateKey:g,publicKey:h,type:i}=a;if(!g)throw Error("Key does not have a private key to sign with.\n\nKey:\n"+A.stringify(a,null,2));let j=c?aJ({domain:{verifyingContract:c},message:{digest:b.payload},primaryType:"ERC1271Sign",types:{ERC1271Sign:[{name:"digest",type:"bytes32"}]}}):b.payload,[k,l]=await (async()=>{if("p256"===i){let{privateKey:b}=a;if("function"==typeof b)return[aC.toHex(aY({payload:j,privateKey:b()})),!1];if(b instanceof CryptoKey)return[aC.toHex(await bd({payload:j,privateKey:b})),!0]}if("secp256k1"===i)return[aC.toHex(aB.sign({payload:j,privateKey:g()})),!1];if("webauthn-p256"===i){if(g.privateKey){let{payload:a,metadata:b}=function(a){let{challenge:b,crossOrigin:c,extraClientData:d,flag:e,origin:f,rpId:g,signCount:h,userVerification:i="required"}=a,j=function(a={}){let{flag:b=5,rpId:c=window.location.hostname,signCount:d=0}=a,e=aG.sha256(ax.fromString(c)),f=ax.fromNumber(b,{size:1}),g=ax.fromNumber(d,{size:4});return ax.concat(e,f,g)}({flag:e,rpId:g,signCount:h}),k=function(a){let{challenge:b,crossOrigin:c=!1,extraClientData:d,origin:e=window.location.origin}=a;return JSON.stringify({type:"webauthn.get",challenge:function(a,b={}){return function(a,b={}){let{pad:c=!0,url:d=!1}=b,e=new Uint8Array(4*Math.ceil(a.length/3));for(let b=0,c=0;c<a.length;b+=4,c+=3){let d=(a[c]<<16)+(a[c+1]<<8)+(0|a[c+2]);e[b]=a2[d>>18],e[b+1]=a2[d>>12&63],e[b+2]=a2[d>>6&63],e[b+3]=a2[63&d]}let f=a.length%3,g=4*Math.floor(a.length/3)+(f&&f+1),h=a1.decode(new Uint8Array(e.buffer,0,g));return c&&1===f&&(h+="=="),c&&2===f&&(h+="="),d&&(h=h.replaceAll("+","-").replaceAll("/","_")),h}(aE.fromHex(a),b)}(b,{url:!0,pad:!1}),origin:e,crossOrigin:c,...d})}({challenge:b,crossOrigin:c,extraClientData:d,origin:f}),l=aG.sha256(ax.fromString(k)),m=k.indexOf('"challenge"'),n=k.indexOf('"type"');return{metadata:{authenticatorData:j,clientDataJSON:k,challengeIndex:m,typeIndex:n,userVerificationRequired:"required"===i},payload:ax.concat(j,l)}}({challenge:j,origin:"https://ithaca.xyz",rpId:"ithaca.xyz"}),{r:c,s:d}=aY({hash:!0,payload:a,privateKey:g.privateKey()});return[bJ({metadata:b,signature:{r:c,s:d}}),!1]}let{credential:b,rpId:c}=g,f=`porto.webauthnVerified.${a.hash}`,h=Date.now(),i=!0;if(d){let a=await d.getItem(f);i=!a||h-a>6e5}let{signature:{r:k,s:l},raw:m,metadata:n}=await a9({challenge:j,credentialId:b.id,getFn:e?.getFn,rpId:c,userVerification:i?"required":"preferred"}),o=m.response;if(!o?.userHandle)throw Error("No user handle in response",{cause:{response:o}});let p=aE.toHex(new Uint8Array(o.userHandle));if(a.id&&aw.validate(a.id)&&!aw.isEqual(a.id,p))throw Error(`supplied webauthn key "${a.id}" does not match signature webauthn key "${p}"`,{cause:{id:p,key:a}});return i&&d&&await d.setItem(f,h),[bJ({metadata:n,signature:{r:k,s:l}}),!1]}throw Error(`Key type "${i}" is not supported.

Key:
`+A.stringify(a,null,2))})();return f?bK(k,{keyType:i,prehash:l,publicKey:h}):k}function bG(a,b={}){let{expiry:c=0,prehash:d=!1,publicKey:e,role:f="admin",type:g}=a,{feeTokens:h,orchestrator:i}=b,j=Object.entries(bH(a,{feeTokens:h})).map(([a,b])=>{if("calls"===a)return b.map(({signature:a,to:b})=>({selector:a?ax.validate(a)?a:aS.getSelector(a):bg,to:b??bf,type:"call"}));if("feeToken"!==a){if("spend"===a)return b.map(({limit:a,period:b,token:c})=>({limit:a,period:b,token:c,type:"spend"}));throw Error(`Invalid permission type "${a}".`)}}).flat().filter(Boolean);return"session"===a.role&&i&&j.push({selector:bg,to:i,type:"call"}),{expiry:c,permissions:j??[],prehash:d,publicKey:bD(e),role:bm[f],type:bl[g]}}function bH(a,b){let{permissions:c}=a,d=c?.calls?[...c.calls]:[],e=c?.spend?[...c.spend]:[],f=b.feeTokens?.filter(a=>a.feeToken);if(f&&f.length>0){let b=bI(a,{feeTokens:f});if(b){let a=-1,c=bo.year;for(let d=0;d<e.length;d++){let f=e[d];if(f.token&&aw.isEqual(b.address,f.token)||!f.token&&b.address===be.zeroAddress){a=d;break}let g=bo[f.period];g<c&&(c=g)}-1!==a?(e[a]={...e[a],limit:e[a].limit+b.value},e.unshift(e.splice(a,1)[0])):"number"==typeof c&&e.unshift({limit:b.value,period:bk[c],token:b.address})}}return{...c,calls:d,spend:e}}function bI(a,b){let{feeTokens:c}=b;if(!a.feeToken)return;let d=c.find(b=>a.feeToken.symbol===b.symbol||(!a.feeToken.symbol||"native"===a.feeToken.symbol)&&b.address===be.zeroAddress);if(!d)return;let e=a$(a.feeToken.limit,d.decimals);return{...d,value:e}}function bJ(a){let{metadata:b,signature:c}=a;return aD.encode(aD.from(["struct WebAuthnAuth { bytes authenticatorData; string clientDataJSON; uint256 challengeIndex; uint256 typeIndex; bytes32 r; bytes32 s; }","WebAuthnAuth auth"]),[{authenticatorData:b.authenticatorData,challengeIndex:BigInt(b.challengeIndex),clientDataJSON:b.clientDataJSON,r:ax.fromNumber(c.r,{size:32}),s:ax.fromNumber(c.s,{size:32}),typeIndex:BigInt(b.typeIndex)}])}function bK(a,b){let{keyType:c,prehash:d=!1,publicKey:e}=b,f=bC({publicKey:e,type:c});return aD.encodePacked(["bytes","bytes32","bool"],[a,f,d])}function bL(a){let b="string"==typeof a?{address:a}:a,c=b.sign?"privateKey":"porto",{address:d,sign:e,signMessage:f,signTransaction:g,signTypedData:h,type:i}=(0,aR.toAccount)({address:b.address,sign({hash:a}){if("porto"===c)throw Error("`sign` not supported on porto accounts.");if(!b.sign)throw Error("`sign` not supported.");return b.sign({hash:a})},signMessage({message:a}){return this.sign({hash:(0,aP.hashMessage)(a)})},signTransaction(){throw Error("`signTransaction` not supported on porto accounts.")},signTypedData(a){return this.sign({hash:(0,aQ.hashTypedData)(a)})}});return{address:d,keys:b.keys??void 0,sign:e,signMessage:f,signTransaction:g,signTypedData:h,source:c,type:i}}function bM(a,b={}){let{keys:c}=b;return bL({address:aw.fromPublicKey(aB.getPublicKey({privateKey:a})),keys:c,sign:async({hash:b})=>aC.toHex(aB.sign({payload:b,privateKey:a})),source:"privateKey"})}function bN(a,b={}){let{key:c,role:d}=b;if(null!==c){if("object"==typeof c)return c;if(a.keys&&a.keys.length>0)return"number"==typeof c?a.keys[c]:a.keys.find(a=>a.privateKey&&(!d||a.role===d))}}async function bO(a,b){let{storage:c,replaySafe:d=!0,wrap:e=!0,webAuthn:f}=b,g=bN(a,b),h=d?aJ({domain:{verifyingContract:a.address},message:{digest:b.payload},primaryType:"ERC1271Sign",types:{ERC1271Sign:[{name:"digest",type:"bytes32"}]}}):b.payload,i=g?({hash:a})=>bF(g,{address:null,payload:a,storage:c,webAuthn:f,wrap:e}):"privateKey"===a.source?a.sign:void 0;if(!i)throw Error("cannot find key to sign with.");return await i({hash:h})}a.s(["from",()=>bL,"fromPrivateKey",()=>bM,"getKey",()=>bN,"sign",()=>bO],987752),a.i(695779);var bP=a.i(469844);function bQ(a,b={}){return bP.from(a,b)}let bR=bQ({inputs:[{name:"message",type:"string"}],name:"Error",type:"error"}),bS=bQ({inputs:[{name:"reason",type:"uint8"}],name:"Panic",type:"error"});var bT=C,bU=a.i(485430),bV=a.i(227972),bW=a.i(284330),bX=a.i(133864),bY=bU;bY.BaseError;class bZ extends bY.BaseError{constructor(){super("Function is not recognized.",{metaMessages:["This could be due to any of the following:","  - The contract does not have the function,","  - The address is not a contract."],name:"FunctionSelectorNotRecognizedError"})}}var b$=a.i(224368),b_=a.i(9239);function b0(a){if(Array.isArray(a))return a.map(b0);if("function"==typeof a)return;if("object"!=typeof a||null===a)return a;if(Object.getPrototypeOf(a)!==Object.prototype)try{return structuredClone(a)}catch{return}let b={};for(let[c,d]of Object.entries(a))b[c]=b0(d);return b}function b1(a,b){let c=[],d=new Set;for(let e of a){let a=b(e);d.has(a)||(d.add(a),c.push(e))}return c}function b2(){return"undefined"!=typeof globalThis&&"crypto"in globalThis?globalThis.crypto.randomUUID():crypto.randomUUID()}function b3(a,{enabled:b=!0,id:c}){if(!b||!c)return a();if(b3.cache.get(c))return b3.cache.get(c);let d=a().finally(()=>b3.cache.delete(c));return b3.cache.set(c,d),d}async function b4(a,b){try{let c="wallet_getAuthorization",d=await (0,az.withCache)(()=>a.request({method:c,params:[aA.encode(b$.wallet_getAuthorization.Parameters,b)]}),{cacheKey:`${a.uid}.${c}.${b.address}`});return aA.decode(b$.wallet_getAuthorization.Response,d)}catch(a){throw cp(a),a}}async function b5(a,b={}){let c=b.chainId?[b.chainId]:"all"!==b.chainIds?b.chainIds?b.chainIds:[a.chain.id]:void 0;try{let d="wallet_getCapabilities",e=await (0,az.withCache)(()=>a.request({method:d,params:c?[c]:void 0},{retryCount:0}),{cacheKey:`${a.uid}.${d}.${c?.join(",")}`}),f=b.raw?e:aA.decode(b$.wallet_getCapabilities.Response,e);if(b.chainIds)return f;return Object.values(f)[0]}catch(a){throw cp(a),a}}async function b6(a,b){let{account:c,assetFilter:d,assetTypeFilter:e,chainFilter:f}=b;try{let b=await a.request({method:"wallet_getAssets",params:[aA.encode(b$.wallet_getAssets.Parameters,{account:c,assetFilter:d,assetTypeFilter:e,chainFilter:f})]}),g=aA.decode(b$.wallet_getAssets.Response,b),h=Object.entries(g).reduce((a,[b,c])=>(a[ax.toNumber(b)]=c,a),{}),i={};for(let a of Object.values(h))for(let b of a){let a=JSON.stringify(b.metadata);i[a]={...b,balance:b.balance+(i[a]?.balance??0n)}}return{...h,0:Object.values(i)}}catch(a){throw cp(a),a}}async function b7(a,b){let{address:c,chain:d=a.chain,tokenAddress:e,value:f}=b;try{let b=await a.request({method:"wallet_addFaucetFunds",params:[aA.encode(b$.wallet_addFaucetFunds.Parameters,{address:c,chainId:d?.id,tokenAddress:e,value:f})]},{retryCount:0});return await new Promise(a=>setTimeout(a,2e3)),b}catch(a){throw cp(a),a}}async function b8(a,b){let{id:c}=b;try{let b=await a.request({method:"wallet_getCallsStatus",params:[c]});return aA.decode(b$.wallet_getCallsStatus.Response,b)}catch(a){throw cp(a),a}}async function b9(a,b){let{address:c,chainIds:d}=b;try{let b=await a.request({method:"wallet_getKeys",params:[aA.encode(b$.wallet_getKeys.Parameters,{address:c,chainIds:d})]});return aA.decode(b$.wallet_getKeys.Response,b)}catch(a){throw cp(a),a}}async function ca(a){let b="health",c=await (0,az.withCache)(()=>a.request({method:b}),{cacheKey:`${a.uid}.${b}`});return aA.decode(b$.health.Response,c)}async function cb(a,b){let{address:c,capabilities:d,chain:e=a.chain,key:f}=b,g=b.calls.map(a=>({data:a.abi?aS.encodeData(aS.fromAbi(a.abi,a.functionName),a.args):a.data??"0x",to:a.to,value:a.value??0n}));try{let b=await a.request({method:"wallet_prepareCalls",params:[aA.encode(b$.wallet_prepareCalls.Parameters,{calls:g,capabilities:{...d,meta:{...d?.meta}},chainId:e?.id,from:c,key:f?{prehash:f.prehash,publicKey:f.publicKey,type:f.type}:void 0})]},{retryCount:0});return Object.assign(aA.decode(b$.wallet_prepareCalls.Response,b),{_raw:b})}catch(a){throw cp(a),co(a,{calls:b.calls}),a}}async function cc(a,b){let{address:c,chain:d=a.chain,delegation:e,...f}=b;try{let b=await a.request({method:"wallet_prepareUpgradeAccount",params:[aA.encode(b$.wallet_prepareUpgradeAccount.Parameters,b0({address:c,capabilities:f,chainId:d?.id,delegation:e}))]},{retryCount:0});return aA.decode(b$.wallet_prepareUpgradeAccount.Response,b)}catch(a){throw cp(a),co(a),a}}async function cd(a,b){let{capabilities:c,context:d,key:e,signature:f}=b;try{let b=await a.request({method:"wallet_sendPreparedCalls",params:[aA.encode(b$.wallet_sendPreparedCalls.Parameters,{capabilities:c,context:{preCall:d.preCall,quote:d.quote},key:e?{prehash:e.prehash,publicKey:e.publicKey,type:e.type}:void 0,signature:f})]},{retryCount:0});return aA.decode(b$.wallet_sendPreparedCalls.Response,b)}catch(a){throw cp(a),co(a),a}}async function ce(a,b){let{address:c,secret:d}=b;try{let b=await a.request({method:"account_getOnrampContactInfo",params:[aA.encode(b$.account_getOnrampContactInfo.Parameters,{address:c,secret:d})]},{retryCount:0});return aA.decode(b$.account_getOnrampContactInfo.Response,b)}catch(a){throw cp(a),co(a),a}}async function cf(a,b){let{address:c}=b;try{let b=await a.request({method:"account_onrampStatus",params:[aA.encode(b$.account_onrampStatus.Parameters,{address:c})]},{retryCount:0});return aA.decode(b$.account_onrampStatus.Response,b)}catch(a){throw cp(a),co(a),a}}async function cg(a,b){let{phone:c,walletAddress:d}=b;try{let b=await a.request({method:"account_resendVerifyPhone",params:[aA.encode(b$.account_resendVerifyPhone.Parameters,{phone:c,walletAddress:d})]},{retryCount:0});return aA.decode(b$.account_resendVerifyPhone.Response,b)}catch(a){throw cp(a),co(a),a}}async function ch(a,b){let{email:c,walletAddress:d}=b;try{let b=await a.request({method:"account_setEmail",params:[aA.encode(b$.account_setEmail.Parameters,{email:c,walletAddress:d})]},{retryCount:0});return aA.decode(b$.account_setEmail.Response,b)}catch(a){throw cp(a),co(a),a}}async function ci(a,b){let{phone:c,walletAddress:d}=b;try{let b=await a.request({method:"account_setPhone",params:[aA.encode(b$.account_setPhone.Parameters,{phone:c,walletAddress:d})]},{retryCount:0});return aA.decode(b$.account_setPhone.Response,b)}catch(a){throw cp(a),co(a),a}}async function cj(a,b){let{context:c,signatures:d}=b;try{await a.request({method:"wallet_upgradeAccount",params:[aA.encode(b$.wallet_upgradeAccount.Parameters,{context:c,signatures:d})]},{retryCount:0})}catch(a){throw cp(a),co(a),a}}async function ck(a,b){let{chainId:c,email:d,signature:e,token:f,walletAddress:g}=b;try{let b=await a.request({method:"account_verifyEmail",params:[aA.encode(b$.account_verifyEmail.Parameters,{chainId:c,email:d,signature:e,token:f,walletAddress:g})]},{retryCount:0});return aA.decode(b$.account_verifyEmail.Response,b)}catch(a){throw cp(a),co(a),a}}async function cl(a,b){let{code:c,phone:d,walletAddress:e}=b;try{let b=await a.request({method:"account_verifyPhone",params:[aA.encode(b$.account_verifyPhone.Parameters,{code:c,phone:d,walletAddress:e})]},{retryCount:0});return aA.decode(b$.account_verifyPhone.Response,b)}catch(a){throw cp(a),co(a),a}}async function cm(a,b){let{signature:c}=b,{signature:d,capabilities:{feeSignature:e,...f},...g}=b.response,h=function a(b){if("object"==typeof b&&null!==b){if(Array.isArray(b))return b.map(a);let c={};for(let d of Object.keys(b).sort())c[d]=a(b[d]);return c}return b}({capabilities:f,...g}),i=aG.keccak256(ax.fromString(JSON.stringify(h))),j=aB.recoverAddress({payload:i,signature:aC.fromHex(c)}),{quoteSigner:k}=await ca(a);return j===k}async function cn(a,b){let{address:c,chain:d=a.chain,digest:e,signature:f}=b;try{async function g(){let b=await (0,bV.verifyHash)(a,{address:c,hash:e,signature:f});return{proof:null,valid:b}}let b=await (async()=>{let b=await a.request({method:"wallet_verifySignature",params:[aA.encode(b$.wallet_verifySignature.Parameters,{address:c,chainId:d?.id,digest:e,signature:f})]},{retryCount:0}).catch(g);return b.valid?b:g()})();return aA.decode(b$.wallet_verifySignature.Response,b)}catch(a){throw cp(a),a}}function co(a,{calls:b}={}){if(!(a instanceof bU.BaseError))return;let c=function(a,b){var c;let d=a.walk(a=>"data"in a);if(!d?.data)return a;if(d.data===(c=bQ("error FnSelectorNotRecognized()"),bP.getSelector(c)))return new bZ;let e=null;for(let a of b.calls)if(a.abi)try{if(!(0,bW.decodeErrorResult)({abi:a.abi,data:d.data}))continue;e=a}catch{}return e?(0,bX.getContractError)(d,{abi:e.abi,address:e.to,args:e.args,functionName:e.functionName}):a}(a,{calls:b??[]}),d=(a=>{try{if("ContractFunctionExecutionError"===a.name){let b="ContractFunctionRevertedError"===a.cause.name?a.cause.data:void 0;if(b)return function(a,b,c){if("Error"===b)return bR;if("Panic"===b)return bS;if(ax.validate(b,{strict:!1})){let a=ax.slice(b,0,4);if("0x08c379a0"===a)return bR;if("0x4e487b71"===a)return bS}let d=bP.fromAbi(a,b,void 0);if("error"!==d.type)throw new bP.NotFoundError({name:b,type:"error"});return d}([b.abiItem],b.errorName)}let b=a.walk(a=>!(a instanceof Error)&&3===a.code);if(!b)return;let{data:c,message:d}=b;if("0xd0d5039b"===c)return bQ("error Unauthorized()");return{inputs:[],name:(d??c).split("(")[0],type:"error"}}catch{return}})(c);if(c!==a||d)throw new cq(Object.assign(c,{abiError:d}))}function cp(a){if("$ZodError"===a.name)throw b_.toValidationError(a)}(b3||(b3={})).cache=new Map;class cq extends bT.BaseError{constructor(a){super("An error occurred while executing calls.",{cause:a,metaMessages:[a.abiError&&"Reason: "+a.abiError.name].filter(Boolean)}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Rpc.ExecutionError"}),Object.defineProperty(this,"abiError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiError=a.abiError}}var cr=a.i(266297),cs=a.i(78138),ct=a.i(199850),cu=a.i(553297);let cv={anvil:{http:"http://localhost:9119"},prod:{http:"https://rpc.porto.sh"},stg:{http:"https://stg-rpc.porto.sh"}};function cw(a){return b=>{let c=a.public(b),d=a.relay(b);return(0,cu.createTransport)({key:cw.type,name:"Relay Proxy",request:async({method:a,params:b},e)=>{var f;return(f=a).startsWith("wallet_")||f.startsWith("account_")||"health"===f?d.request({method:a,params:b},e):c.request({method:a,params:b},e)},type:cw.type})}}(cw||(cw={})).type="relayProxy",a.s(["relayProxy",()=>cw,"relayUrls",0,cv],242463);let cx=new Map;var cy=a.i(566247);let cz=cy.Permissions;function cA(a,b){let{chainId:c,expiry:d,permissions:e,id:f,publicKey:g,type:h}=a,{address:i}=b;return{address:i,chainId:c,expiry:d,id:f,key:{publicKey:g,type:h},permissions:e??{}}}function cB(a){let{chainId:b,expiry:c,key:d}=a;return bv({chainId:b,expiry:c,permissions:a.permissions??{},publicKey:d.publicKey,role:"session",type:d.type})}var cC=a.i(192170),cD=a.i(290725);let cE=cC.discriminatedUnion("method",[cD.account_verifyEmail.Request,cD.wallet_addFunds.Request,cD.eth_accounts.Request,cD.eth_chainId.Request,cD.eth_requestAccounts.Request,cD.eth_sendTransaction.Request,cD.eth_signTypedData_v4.Request,cD.wallet_getAccountVersion.Request,cD.wallet_getAdmins.Request,cD.wallet_getPermissions.Request,cD.wallet_grantAdmin.Request,cD.wallet_grantPermissions.Request,cD.wallet_prepareUpgradeAccount.Request,cD.wallet_revokeAdmin.Request,cD.wallet_revokePermissions.Request,cD.wallet_upgradeAccount.Request,cD.personal_sign.Request,cD.porto_ping.Request,cD.wallet_connect.Request,cD.wallet_disconnect.Request,cD.wallet_getAssets.Request,cD.wallet_getCallsStatus.Request,cD.wallet_getCapabilities.Request,cD.wallet_getKeys.Request,cD.wallet_prepareCalls.Request,cD.wallet_sendCalls.Request,cD.wallet_sendPreparedCalls.Request,cD.wallet_switchEthereumChain.Request,cD.wallet_verifySignature.Request]);function cF(a,b){let c=aA.safeParse(a,b);if(c.error){let a=c.error.issues.at(0);if(a?.code==="invalid_union"&&"No matching discriminator"===a.note)throw new J;throw new O(b_.toValidationError(c.error))}return{...b,_decoded:c.data}}async function cG(a){a.persist.hasHydrated()||await new Promise(b=>{a.persist.onFinishHydration(()=>b(!0)),setTimeout(()=>b(!0),100)})}function cH(a){if(a)return a.startsWith("/")?`${window.location.origin}${a}`:a}function cI(a){let b,c,d,e,{config:f,getMode:g,id:h,store:i}=a,{announceProvider:j}=f;function k(a={}){let b=l(),c=a.request??cF(cE,{method:"wallet_getCapabilities",params:a.chainIds?[void 0,a.chainIds]:void 0});return(0,az.withCache)(()=>g().actions.getCapabilities({chainIds:a.chainIds,internal:{client:b,config:f,request:c,store:i}}),{cacheKey:`getCapabilities.${h}.${a.chainIds?.join(",")}`})}function l(b){return function(a,b={}){let{config:c,id:d,store:e}=a._internal,{chains:f,relay:g}=c,h=e.getState(),i=b.chainId??h.chainIds[0],j=f.find(a=>a.id===i);if(!j)throw Error(`Could not find a compatible Porto chain on the given chain configuration.

Provided chains: [${f.map(a=>`${a.name} (id: ${a.id})`).join(", ")}]
Needed chain (id): ${i}
Please add this chain (id) to your chain configuration.`);let k=cw({public:c.transports[j.id]??(0,cs.fallback)(j.rpcUrls.default.http.map(a=>(0,ct.http)(a))),relay:g}),l=[d,A.stringify(j)].filter(Boolean).join(":");if(cx.has(l))return cx.get(l);let m=(0,cr.createClient)({...b,chain:j,pollingInterval:1e3,transport:k});return cx.set(l,m),m}({_internal:a},{chainId:"string"==typeof b?ax.toNumber(b):b})}let m=new Map,n=[],o={get eventNames(){return b.eventNames.bind(b)},get listenerCount(){return b.listenerCount.bind(b)},get listeners(){return b.listeners.bind(b)},addListener:(b=new B.EventEmitter).addListener.bind(b),emit:b.emit.bind(b),off:b.off.bind(b),on:b.on.bind(b),once:b.once.bind(b),removeAllListeners:b.removeAllListeners.bind(b),removeListener:b.removeListener.bind(b)},p=ad({...o,async request(a){await cG(i);let b=["eth_accounts","eth_chainId","eth_requestAccounts","wallet_getAssets","wallet_getCapabilities","wallet_getKeys","wallet_getPermissions","wallet_getAccountVersion","wallet_connect"].includes(a.method);return b3(async()=>{let b;try{b=cF(cE,a)}catch(b){if(!(b instanceof J))throw b;if(a.method.startsWith("wallet_"))throw new U;return l().request(a)}let c=i.getState();switch(b.method){case"account_verifyEmail":{if(0===c.accounts.length)throw new V;let[a]=b._decoded.params,{chainId:d,email:e,token:h,walletAddress:j}=a,k=l(d);if(d&&d!==k.chain.id)throw new W;let m=j?c.accounts.find(a=>aw.isEqual(a.address,j)):c.accounts[0];if(!m)throw new T;return await g().actions.verifyEmail({account:m,chainId:d,email:e,internal:{client:k,config:f,request:b,store:i},token:h,walletAddress:j})}case"wallet_addFunds":{if(0===c.accounts.length)throw new V;let{address:a,value:d,token:e}=b.params[0]??{},h=a?c.accounts.find(b=>aw.isEqual(b.address,a)):c.accounts[0];if(!h)throw new T;let j=l(),k=await g().actions.addFunds({address:h.address,internal:{client:j,config:f,request:b,store:i},token:e,value:d});return o.emit("message",{data:null,type:"assetsChanged"}),k}case"eth_accounts":if(0===c.accounts.length)throw new V;return c.accounts.map(cL);case"eth_chainId":return ax.fromNumber(c.chainIds[0]);case"eth_requestAccounts":{if(c.accounts.length>0&&m.get("eth_requestAccounts"))return c.accounts.map(cL);let a=l(),{accounts:d}=await g().actions.loadAccounts({internal:{client:a,config:f,request:b,store:i}});return i.setState(a=>({...a,accounts:d})),o.emit("connect",{chainId:ax.fromNumber(a.chain.id)}),m.set("eth_requestAccounts",!0),setTimeout(()=>m.delete("eth_requestAccounts"),1e3),d.map(cL)}case"eth_sendTransaction":{if(0===c.accounts.length)throw new V;let[{capabilities:a,chainId:d,data:e="0x",from:h,to:j,value:k}]=b._decoded.params,m=l(d);if(d&&d!==m.chain.id)throw new W;let n=h?c.accounts.find(a=>aw.isEqual(a.address,h)):c.accounts[0];if(!n)throw new T;let{id:o}=await g().actions.sendCalls({account:n,asTxHash:!0,calls:[{data:e,to:j,value:k}],chainId:m.chain.id,internal:{client:m,config:f,request:b,store:i},merchantUrl:cH(f.merchantUrl??a?.merchantUrl)});return o}case"eth_signTypedData_v4":{if(0===c.accounts.length)throw new V;let[a,d]=b._decoded.params,e=c.accounts.find(b=>aw.isEqual(b.address,a));if(!e)throw new T;let h=l();return await g().actions.signTypedData({account:e,data:d,internal:{client:h,config:f,request:b,store:i}})}case"wallet_grantAdmin":{if(0===c.accounts.length)throw new V;let[{address:a,capabilities:d,chainId:e,key:h}]=b._decoded.params??[{}],j=a?c.accounts.find(b=>aw.isEqual(b.address,a)):c.accounts[0];if(!j)throw new T;let k=l(e);if(cJ([...j.keys??[]])?.some(a=>a.publicKey?.toLowerCase()===h.publicKey.toLowerCase()))throw new O({message:"Key already granted as admin."});let{key:m}=await g().actions.grantAdmin({account:j,feeToken:d?.feeToken,internal:{client:k,config:f,request:b,store:i},key:h});i.setState(a=>{let b=a.accounts.findIndex(a=>!j||aw.isEqual(a.address,j.address));return -1===b?a:{...a,accounts:a.accounts.map((a,c)=>c===b?{...a,keys:[...a.keys??[],m]}:a)}});let n=cJ([...j.keys??[],m]);return o.emit("message",{data:null,type:"adminsChanged"}),aA.encode(cD.wallet_grantAdmin.Response,{address:j.address,chainId:k.chain.id,key:n.at(-1)})}case"wallet_grantPermissions":{if(0===c.accounts.length)throw new V;let[{address:a,chainId:d,...e}]=b._decoded.params??[{}],h=a?c.accounts.find(b=>aw.isEqual(b.address,a)):c.accounts[0];if(!h)throw new T;let j=l(d),{key:k}=await g().actions.grantPermissions({account:h,internal:{client:j,config:f,request:b,store:i},permissions:e});return i.setState(a=>{let b=a.accounts.findIndex(a=>!h||aw.isEqual(a.address,h.address));return -1===b?a:{...a,accounts:a.accounts.map((a,c)=>c===b?{...a,keys:[...a.keys??[],k]}:a)}}),o.emit("message",{data:null,type:"permissionsChanged"}),aA.encode(cD.wallet_grantPermissions.Response,{...cA(k,{address:h.address})})}case"wallet_getAdmins":{if(0===c.accounts.length)throw new V;let[{address:a,chainId:d}]=b._decoded.params??[{}],e=a?c.accounts.find(b=>aw.isEqual(b.address,a)):c.accounts[0];if(!e)throw new T;let h=l(d),j=cJ(await g().actions.getKeys({account:e,internal:{client:h,config:f,request:b,store:i}}));return aA.encode(cD.wallet_getAdmins.Response,{address:e.address,chainId:h.chain.id,keys:j})}case"wallet_prepareUpgradeAccount":{let[{address:a,capabilities:c,chainId:d}]=b._decoded.params??[{}],{email:e,label:h,grantPermissions:j}=c??{},k=l(d),{context:m,digests:o}=await g().actions.prepareUpgradeAccount({address:a,email:e,internal:{client:k,config:f,request:b,store:i},label:h,permissions:j});return n.push(m.account),{context:m,digests:o}}case"wallet_getAccountVersion":{if(0===c.accounts.length)throw new V;let[{address:a}]=b._decoded.params??[{}],d=a?c.accounts.find(b=>aw.isEqual(b.address,a)):c.accounts[0];if(!d)throw new T;let e=l(),{current:h,latest:j}=await g().actions.getAccountVersion({address:d.address,internal:{client:e,config:f,request:b,store:i}});return{current:h,latest:j}}case"wallet_getKeys":{if(0===c.accounts.length)throw new V;let[{address:a,chainIds:d}]=b._decoded.params??[{}],e=c.accounts.find(b=>aw.isEqual(b.address,a));if(!e)throw new T;let h=l(),j=await g().actions.getKeys({account:e,chainIds:d,internal:{client:h,config:f,request:b,store:i}});return aA.encode(cD.wallet_getKeys.Response,j)}case"wallet_getPermissions":{if(0===c.accounts.length)throw new V;let[{address:a,chainIds:d}]=b._decoded.params??[{}],e=a?c.accounts.find(b=>aw.isEqual(b.address,a)):c.accounts[0];if(!e)throw new T;let h=l();return cK(await g().actions.getKeys({account:e,chainIds:d,internal:{client:h,config:f,request:b,store:i}}),{address:e.address})}case"wallet_revokeAdmin":{if(0===c.accounts.length)throw new V;let[{address:a,capabilities:d,id:e}]=b._decoded.params,h=a?c.accounts.find(b=>aw.isEqual(b.address,a)):c.accounts[0];if(!h)throw new T;let j=l();await g().actions.revokeAdmin({account:h,feeToken:d?.feeToken,id:e,internal:{client:j,config:f,request:b,store:i}});let k=h.keys?.filter(a=>a.id.toLowerCase()!==e.toLowerCase());i.setState(a=>({...a,accounts:a.accounts.map(a=>aw.isEqual(a.address,h.address)?{...a,keys:k}:a)})),o.emit("message",{data:null,type:"adminsChanged"});return}case"wallet_revokePermissions":{if(0===c.accounts.length)throw new V;let[{address:a,capabilities:d,id:e}]=b._decoded.params,h=a?c.accounts.find(b=>aw.isEqual(b.address,a)):c.accounts[0];if(!h)throw new T;let j=l();await g().actions.revokePermissions({account:h,feeToken:d?.feeToken,id:e,internal:{client:j,config:f,request:b,store:i}});let k=h.keys?.filter(a=>a.id.toLowerCase()!==e.toLowerCase());i.setState(a=>({...a,accounts:a.accounts.map(a=>aw.isEqual(a.address,h.address)?{...a,keys:k}:a)})),o.emit("message",{data:null,type:"permissionsChanged"});return}case"wallet_upgradeAccount":{let[{context:a,signatures:c}]=b._decoded.params??[{}],d=l(),e=n.find(b=>aw.isEqual(b.address,a.account.address));if(!e)throw new T;let{account:h}=await g().actions.upgradeAccount({account:e,context:a,internal:{client:d,config:f,request:b,store:i},signatures:c}),j=cJ(h.keys??[]),k=cK(h.keys??[],{address:h.address});return i.setState(a=>({...a,accounts:[h]})),o.emit("connect",{chainId:ax.fromNumber(d.chain.id)}),{address:h.address,capabilities:{admins:j,...k.length>0?{permissions:k}:{}}}}case"porto_ping":return"pong";case"personal_sign":{if(0===c.accounts.length)throw new V;let[a,d]=b._decoded.params,e=c.accounts.find(a=>aw.isEqual(a.address,d));if(!e)throw new T;let h=l();return await g().actions.signPersonalMessage({account:e,data:a,internal:{client:h,config:f,request:b,store:i}})}case"wallet_connect":{let[{capabilities:a,chainIds:d}]=b._decoded.params??[{}],e=l(d?.[0]),h=e.chain.id,{createAccount:j,email:k,grantAdmins:m,grantPermissions:n,selectAccount:p,signInWithEthereum:q}=a??{},r={client:e,config:f,request:b,store:i},{accounts:s}=await (async()=>{if(k||j){let{label:a}="object"==typeof j?j:{},{account:b}=await g().actions.createAccount({admins:m,email:k,internal:r,label:a,permissions:n,signInWithEthereum:q});return{accounts:[b]}}let a=c.accounts[0],{address:b,key:d}=(()=>{if(p)return"object"==typeof p?p:{address:void 0,key:void 0};for(let b of a?.keys??[])if("webauthn-p256"===b.type&&"admin"===b.role)return{address:a?.address,key:{credentialId:b.credentialId??b.privateKey?.credential?.id,publicKey:b.publicKey}};return{address:void 0,key:void 0}})(),e={internal:r,permissions:n,signInWithEthereum:q};try{return await g().actions.loadAccounts({address:b,key:d,...e})}catch(a){if(a instanceof S)throw a;if(b&&d)return await g().actions.loadAccounts(e);throw a}})();i.setState(a=>({...a,accounts:s}));let t=[h,...i.getState().chainIds.filter(a=>a!==h)];return o.emit("connect",{chainId:ax.fromNumber(t[0])}),{accounts:s.map(a=>({address:cL(a),capabilities:{admins:a.keys?cJ(a.keys):[],permissions:a.keys?cK(a.keys,{address:a.address}):[],...a.signInWithEthereum&&{signInWithEthereum:a.signInWithEthereum}}})),chainIds:t.map(a=>ax.fromNumber(a))}}case"wallet_disconnect":{let a=l();await g().actions.disconnect?.({internal:{client:a,config:f,request:b,store:i}}),i.setState(a=>({...a,accounts:[]})),o.emit("disconnect",new V);return}case"wallet_getAssets":{let[a]=b._decoded.params??[],{account:c,chainFilter:d,assetFilter:e,assetTypeFilter:h}=a,j=l(),k=Object.entries(await g().actions.getAssets({account:c,assetFilter:e,assetTypeFilter:h,chainFilter:d,internal:{client:j,config:f,request:b,store:i}})).reduce((a,[b,c])=>(a[ax.fromNumber(Number(b))]=c,a),{});return aA.encode(cD.wallet_getAssets.Response,k)}case"wallet_getCallsStatus":{let[a]=b._decoded.params??[],c=l();return await g().actions.getCallsStatus({id:a,internal:{client:c,config:f,request:b,store:i}})}case"wallet_getCapabilities":{let[a,c]=b.params??[];return await k({chainIds:c,request:b})}case"wallet_prepareCalls":{let[a]=b._decoded.params,{calls:d,capabilities:e,chainId:h,key:j,from:k}=a,m=l(h),n=k??c.accounts[0];if(!n)throw new T;if(h&&h!==m.chain.id)throw new W;let{digest:o,...p}=await g().actions.prepareCalls({account:bL(n),calls:d,feeToken:e?.feeToken,internal:{client:m,config:f,request:b,store:i},key:j,merchantUrl:cH(f.merchantUrl??e?.merchantUrl),requiredFunds:e?.requiredFunds});return aA.encode(cD.wallet_prepareCalls.Response,{capabilities:p.capabilities,chainId:ax.fromNumber(p.chainId??m.chain.id),context:{...p.context,account:{address:p.account.address},calls:p.context.calls??[],nonce:p.context.nonce??0n},digest:o,key:p.key,typedData:p.typedData})}case"wallet_sendPreparedCalls":{let[a]=b._decoded.params,{chainId:c,context:d,key:e,signature:h}=a,{account:j}=a.context,k=l(c);if(c&&ax.toNumber(c)!==k.chain.id)throw new W;return[{id:await g().actions.sendPreparedCalls({account:bL(j),context:d,internal:{client:k,config:f,request:b,store:i},key:e,signature:h})}]}case"wallet_sendCalls":{if(0===c.accounts.length)throw new V;let[a]=b._decoded.params,{calls:d,capabilities:e,chainId:h,from:j}=a,k=l(h);if(h&&h!==k.chain.id)throw new W;let m=j?c.accounts.find(a=>aw.isEqual(a.address,j)):c.accounts[0];if(!m)throw new T;let{id:n}=await g().actions.sendCalls({account:m,calls:d,chainId:k.chain.id,feeToken:e?.feeToken,internal:{client:k,config:f,request:b,store:i},merchantUrl:cH(f.merchantUrl??e?.merchantUrl),permissionsId:e?.permissions?.id,requiredFunds:e?.requiredFunds});return{id:n}}case"wallet_switchEthereumChain":{let[a]=b._decoded.params,{chainId:c}=a,d=ax.toNumber(c);if(!f.chains.find(a=>a.id===d))throw new Z;let e=l(c);await g().actions.switchChain?.({chainId:e.chain.id,internal:{client:e,config:f,request:b,store:i}}),i.setState(a=>({...a,chainIds:[d,...a.chainIds.filter(a=>a!==d)]}));return}case"wallet_verifySignature":{let[a]=b._decoded.params,{address:c,chainId:d,digest:e,signature:f}=a,g=l(d);return{...await cn(g,{address:c,digest:e,signature:f}),address:c,chainId:ax.fromNumber(g.chain.id)}}}},{enabled:b,id:A.stringify(a)})}});return Object.assign(p,{_internal:{destroy:(c=()=>{},d=()=>{},cG(i).then(()=>{k().catch(()=>{}),c(),c=i.subscribe(a=>a.accounts,a=>{o.emit("accountsChanged",a.map(cL))},{equalityFn:(a,b)=>a.every((a,c)=>a.address===b[c]?.address)}),d(),d=i.subscribe(a=>a.chainIds[0],(a,b)=>{a!==b&&o.emit("chainChanged",ax.fromNumber(a))})}),e=j?()=>{}:()=>{},()=>{c(),d(),e()})}})}function cJ(a){return a.map(a=>{if("admin"===a.role)try{return aA.encode(cD.wallet_getAdmins.Key,{id:a.id??a.publicKey,publicKey:a.publicKey,type:a.type,..."webauthn-p256"===a.type?{credentialId:a.privateKey?.credential?.id,privateKey:{credential:{id:a.privateKey?.credential?.id},rpId:a.privateKey?.rpId}}:{}})}catch{return}}).filter(Boolean)}function cK(a,{address:b}){return a.map(a=>{if(a.chainId&&"session"===a.role&&!(a.expiry>0&&a.expiry<BigInt(Math.floor(Date.now()/1e3))))try{return aA.encode(cz,cA(a,{address:b}))}catch{return}}).filter(Boolean)}function cL(a){return(0,ay.getAddress)(a.address)}function cM(a){return a}function cN(a,b={}){let{targetOrigin:c}=b,d=new Map;return{destroy(){for(let b of d.values())a.removeEventListener("message",b)},on(b,e,f){function g(a){a.data.topic!==b||f&&a.data.id!==f||c&&a.origin!==c||e(a.data.payload,a)}return a.addEventListener("message",g),d.set(b,g),()=>a.removeEventListener("message",g)},async send(b,d,e){let f=b2();return a.postMessage(b0({id:f,payload:d,topic:b}),e??c??"*"),{id:f,payload:d,topic:b}},async sendAsync(a,b,c){let{id:d}=await this.send(a,b,c);return new Promise(b=>this.on(a,b,d))}}}function cO(a){let b,c,{from:d,to:e,waitForReady:f=!1}=a,g=!1,h=(b=()=>void 0,c=()=>void 0,{promise:new Promise((a,d)=>{b=a,c=d}),reject:c,resolve:b});d.on("ready",h.resolve);let i={destroy(){d.destroy(),e.destroy(),g&&h.reject()},on:(a,b,c)=>d.on(a,b,c),send:async(a,b)=>(g=!0,f&&await h.promise.finally(()=>g=!1),e.send(a,b)),sendAsync:async(a,b)=>(g=!0,f&&await h.promise.finally(()=>g=!1),e.sendAsync(a,b))};return{...i,ready(a){i.send("ready",a)},waitForReady:()=>h.promise}}function cP(){return{destroy(){},on:()=>()=>{},ready(){},send:()=>Promise.resolve(void 0),sendAsync:()=>Promise.resolve(void 0),waitForReady:()=>Promise.resolve(void 0)}}function cQ(a){let{relayUrl:b}=a,c=null,d=new Map;async function e(a,c){let d=b2(),e=await fetch(b,{body:A.stringify({id:d,payload:c,topic:a}),headers:{"Content-Type":"application/json"},method:"POST"});return{id:d,payload:c,response:e,topic:a}}return!function a(){b&&!c&&((c=new EventSource(b)).onmessage=a=>{try{let c=JSON.parse(a.data);if(!c.topic||!c.payload)return;let e=d.get(c.topic);if(!e)return;for(let a of e)a(c.payload,{data:c,origin:b})}catch(a){console.error("Error parsing SSE message:",a)}},c.onerror=b=>{console.error("SSE connection error:",b),c?.close(),c=null,setTimeout(a,1e3)})}(),{destroy(){c?.close(),c=null,d.clear()},on:(a,b)=>(d.has(a)||d.set(a,new Set),d.get(a).add(b),()=>{let c=d.get(a);c&&(c.delete(b),0===c.size&&d.delete(a))}),async ready(a){await new Promise(a=>setTimeout(a,32)),this.send("ready",a)},async send(a,b){let{id:c}=await e(a,b);return{id:c,payload:b,topic:a}},async sendAsync(a,b){let{response:c}=await e(a,b);if(!c.ok)throw Error(`HTTP ${c.status}: ${c.statusText}`);let d=c.headers.get("content-type");if(d?.includes("application/json"))return await c.json()}}}a.s(["bridge",()=>cO,"cliRelay",()=>cQ,"from",()=>cM,"fromWindow",()=>cN,"noop",()=>cP],851861);var cR=a.i(851861);function cS(a){return{...a,setup:a.setup??(()=>()=>{})}}async function cT(a){let{account:b,calls:c,permissionsId:d}=a;if(void 0!==d){if(null===d)return;let a=b.keys?.find(a=>a.publicKey===d&&a.privateKey);if(!a)throw Error(`permission (id: ${d}) does not exist.`);return a}let e=b.keys?.find(a=>!(!a.privateKey||"session"!==a.role||a.expiry<BigInt(Math.floor(Date.now()/1e3)))&&!!c.every(b=>a.permissions?.calls?.some(a=>{if(a.to&&a.to!==b.to)return!1;if(a.signature){if(!b.data)return!1;let c=ax.slice(b.data,0,4);if(ax.validate(a.signature))return a.signature===c;if(bP.getSelector(a.signature)!==c)return!1}return!0}))),f=b.keys?.find(a=>"admin"===a.role&&a.privateKey);return e??f}a.s([],11878),a.i(11878);var cU=a.i(513120);let cV=cy.Request;function cW(a){let{expiry:b,feeToken:c,permissions:d,publicKey:e,type:f}=a;return{expiry:b,feeToken:c??null,key:{publicKey:e,type:f},permissions:d??{}}}async function cX(a,b={}){if(!a)return;let c=b.chainId??a.chainId,d=a.expiry??0,e={chainId:c,expiry:d,feeToken:a.feeToken,permissions:bH(a,{feeTokens:b.feeTokens}),role:"session"};if(a?.key)return bv({...e,publicKey:a.key.publicKey,type:a.key.type??"secp256k1"});if("function"==typeof globalThis.crypto?.subtle?.generateKey)try{return await bt(e)}catch(a){if(!function(a){if(!(a instanceof Error))return!1;let b=a.message?.toLowerCase()??"";return"TypeError"===a.name||"ReferenceError"===a.name||b.includes("subtle")||b.includes("generatekey")}(a))throw a}return bp(e)}var cY=C;let cZ=/^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}(:[0-9]{1,5})?$/,c$=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(:[0-9]{1,5})?$/,c_=/^localhost(:[0-9]{1,5})?$/,c0=/^[a-zA-Z0-9]{8,}$/,c1=/^([a-zA-Z][a-zA-Z0-9+-.]*)$/,c2=/^(?:(?<scheme>[a-zA-Z][a-zA-Z0-9+-.]*):\/\/)?(?<domain>[a-zA-Z0-9+-.]*(?::[0-9]{1,5})?) (?:wants you to sign in with your Ethereum account:\n)(?<address>0x[a-fA-F0-9]{40})\n\n(?:(?<statement>.*)\n\n)?/,c3=/(?:URI: (?<uri>.+))\n(?:Version: (?<version>.+))\n(?:Chain ID: (?<chainId>\d+))\n(?:Nonce: (?<nonce>[a-zA-Z0-9]+))\n(?:Issued At: (?<issuedAt>.+))(?:\nExpiration Time: (?<expirationTime>.+))?(?:\nNot Before: (?<notBefore>.+))?(?:\nRequest ID: (?<requestId>.+))?/;function c4(a){if(/[^a-z0-9:/?#[\]@!$&'()*+,;=.\-_~%]/i.test(a)||/%[^0-9a-f]/i.test(a)||/%[0-9a-f](:?[^0-9a-f]|$)/i.test(a))return!1;let b=a.match(/(?:([^:/?#]+):)?(?:\/\/([^/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/),c=b[1],d=b[2],e=b[3],f=b[4],g=b[5];if(!(c?.length&&e&&e.length>=0))return!1;if(d?.length){if(!(0===e.length||/^\//.test(e)))return!1}else if(/^\/\//.test(e))return!1;if(!/^[a-z][a-z0-9+\-.]*$/.test(c.toLowerCase()))return!1;let h="";return h+=`${c}:`,d?.length&&(h+=`//${d}`),h+=e,f?.length&&(h+=`?${f}`),g?.length&&(h+=`#${g}`),h}class c5 extends cY.BaseError{constructor(a){const{field:b,metaMessages:c}=a;super(`Invalid Sign-In with Ethereum message field "${b}".`,{metaMessages:c}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Siwe.InvalidMessageFieldError"})}}async function c6(a){let{address:b,authUrl:c,message:d,signature:e,publicKey:f}=a,{chainId:g}=function(a){let{scheme:b,statement:c,...d}=a.match(c2)?.groups??{},{chainId:e,expirationTime:f,issuedAt:g,notBefore:h,requestId:i,...j}=a.match(c3)?.groups??{},k=a.split("Resources:")[1]?.split("\n- ").slice(1);return{...d,...j,...e?{chainId:Number(e)}:{},...f?{expirationTime:new Date(f)}:{},...g?{issuedAt:new Date(g)}:{},...h?{notBefore:new Date(h)}:{},...i?{requestId:i}:{},...k?{resources:k}:{},...b?{scheme:b}:{},...c?{statement:c}:{}}}(d);return await fetch(c.verify,{body:JSON.stringify({address:b,chainId:g,message:d,signature:e,walletAddress:b,...f&&{publicKey:f}}),credentials:"include",headers:{"Content-Type":"application/json"},method:"POST"}).then(a=>a.json())}async function c7(a,b,c){let{chainId:d=a.chain?.id,domain:e,uri:f,resources:g,version:h="1"}=b,{address:i}=c,j=b.authUrl?c8(b.authUrl):void 0;if(!d)throw Error("`chainId` is required.");if(!e)throw Error("`domain` is required.");if(!b.nonce&&!j?.nonce)throw Error("`nonce` or `authUrl.nonce` is required.");if(!f)throw Error("`uri` is required.");let k=await (async()=>{if(b.nonce)return b.nonce;if(!j?.nonce)throw Error("`nonce` or `authUrl.nonce` is required.");let a=await fetch(j.nonce,{body:JSON.stringify({address:i,chainId:d,walletAddress:i}),headers:{"Content-Type":"application/json"},method:"POST"}),c=await a.json().catch(()=>void 0);if(!c?.nonce)throw Error("`nonce` or `authUrl.nonce` is required.");return c.nonce})();return function(a){let{chainId:b,domain:c,expirationTime:d,issuedAt:e=new Date,nonce:f,notBefore:g,requestId:h,resources:i,scheme:j,uri:k,version:l}=a;{if(b!==Math.floor(b))throw new c5({field:"chainId",metaMessages:["- Chain ID must be a EIP-155 chain ID.","- See https://eips.ethereum.org/EIPS/eip-155","",`Provided value: ${b}`]});if(!(cZ.test(c)||c$.test(c)||c_.test(c)))throw new c5({field:"domain",metaMessages:["- Domain must be an RFC 3986 authority.","- See https://www.rfc-editor.org/rfc/rfc3986","",`Provided value: ${c}`]});if(!c0.test(f))throw new c5({field:"nonce",metaMessages:["- Nonce must be at least 8 characters.","- Nonce must be alphanumeric.","",`Provided value: ${f}`]});if(!c4(k))throw new c5({field:"uri",metaMessages:["- URI must be a RFC 3986 URI referring to the resource that is the subject of the signing.","- See https://www.rfc-editor.org/rfc/rfc3986","",`Provided value: ${k}`]});if("1"!==l)throw new c5({field:"version",metaMessages:["- Version must be '1'.","",`Provided value: ${l}`]});if(j&&!c1.test(j))throw new c5({field:"scheme",metaMessages:["- Scheme must be an RFC 3986 URI scheme.","- See https://www.rfc-editor.org/rfc/rfc3986#section-3.1","",`Provided value: ${j}`]});let d=a.statement;if(d?.includes("\n"))throw new c5({field:"statement",metaMessages:["- Statement must not include '\\n'.","",`Provided value: ${d}`]})}let m=aw.from(a.address,{checksum:!0}),n=j?`${j}://${c}`:c,o=a.statement?`${a.statement}
`:"",p=`${n} wants you to sign in with your Ethereum account:
${m}

${o}`,q=`URI: ${k}
Version: ${l}
Chain ID: ${b}
Nonce: ${f}
Issued At: ${e.toISOString()}`;if(d&&(q+=`
Expiration Time: ${d.toISOString()}`),g&&(q+=`
Not Before: ${g.toISOString()}`),h&&(q+=`
Request ID: ${h}`),i){let a="\nResources:";for(let b of i){if(!c4(b))throw new c5({field:"resources",metaMessages:["- Every resource must be a RFC 3986 URI.","- See https://www.rfc-editor.org/rfc/rfc3986","",`Provided value: ${b}`]});a+=`
- ${b}`}q+=a}return`${p}
${q}`}({...b,address:c.address,chainId:d,domain:e,nonce:k,resources:g,uri:f,version:h})}function c8(a,b=""){if(!a)return;let c=(()=>{if("string"==typeof a){let b=a.replace(/\/$/,"");return{logout:b+"/logout",nonce:b+"/nonce",verify:b+"/verify"}}return a})();return{logout:c9(c.logout,b),nonce:c9(c.nonce,b),verify:c9(c.verify,b)}}function c9(a,b){return b&&a.startsWith("/")?b+a:a}function da(a){let b;return aG.keccak256((b=ax.from(a),ax.concat("0x19",ax.fromString("Ethereum Signed Message:\n"+ax.size(b)),b)))}a.i(803584);a.i(883448),a.i(563014),a.i(50964);var db=a.i(852434);async function dc(a,b){let{account:c=a.account}=b,d=c?bL(c):void 0;if(!d)throw Error("account is required.");let{domain:{name:e,version:f}}=await (0,db.getEip712Domain)(a,{address:d.address});if(!a.chain)throw Error("client.chain is required");return{chainId:a.chain.id,name:e,verifyingContract:d.address,version:f}}async function dd(a,b){let c=bM(aB.randomPrivateKey(),{keys:b.authorizeKeys});return await dq(a,{...b,account:c})}async function de(a,b){let{account:c=a.account,chainIds:d}=b,e=c?bL(c):void 0;if(!e)throw Error("account is required.");return Object.entries(await b9(a,{address:e.address,chainIds:d})).flatMap(([a,b])=>b.map(b=>bx(b,{chainId:Number(a)})))}async function df(a,b){let{address:c,secret:d}=b;return await ce(a,{address:c,secret:d})}async function dg(a,b){let{address:c}=b;return await cf(a,{address:c})}async function dh(a,b){let{account:c=a.account,calls:d,chain:e=a.chain,feePayer:f,merchantUrl:g,nonce:h,preCalls:i,requiredFunds:j,revokeKeys:k}=b,l=c?bL(c):void 0,m=b.key??(l?bN(l,{role:"admin"}):void 0),n=b.authorizeKeys?.some(a=>"session"===a.role),{contracts:o,fees:{tokens:p}}=await b5(a,{chainId:e?.id}),q=n?o.orchestrator.address:void 0,r=(b.authorizeKeys??[]).map(a=>bG(a,{feeTokens:p,orchestrator:q})),s=b.feeToken?b.feeToken:m?.permissions?.spend?.[0]?.token,t="boolean"==typeof i&&i,u="object"==typeof i?i.map(({context:a,signature:b})=>({...a.preCall,signature:b})):void 0,v={address:l?.address,calls:d??[],capabilities:{authorizeKeys:r,meta:{feePayer:f,feeToken:s,nonce:h},preCall:t,preCalls:u,requiredFunds:j,revokeKeys:k?.map(a=>({hash:a.hash}))},chain:e,key:m?bG(m,{feeTokens:p}):void 0},w=await (async()=>{if(g){let b=(0,cr.createClient)({chain:a.chain,transport:(0,ct.http)(g)});return await cb(b,v).catch(b=>(console.error(b),cb(a,v)))}return await cb(a,v)})(),{capabilities:x,context:y,digest:z,signature:A,typedData:B}=w;if(g&&!await cm(a,{response:w._raw,signature:A}))throw Error(`cannot verify integrity of \`wallet_prepareCalls\` response from ${g}`);return{capabilities:{...x,quote:y.quote},context:y,digest:z,key:m,typedData:B}}async function di(a,b){let{address:c,authorizeKeys:d,chain:e=a.chain}=b;if(!e)throw Error("chain is required.");let{contracts:f,fees:{tokens:g}}=await b5(a,{chainId:e.id}),h=b.delegation??f.accountProxy.address,i=d.some(a=>"session"===a.role)?f.orchestrator.address:void 0,j=d.map(a=>{let b="session"===a.role?a.permissions:{};return bG({...a,permissions:b},{feeTokens:g,orchestrator:i})}),{capabilities:k,chainId:l,context:m,digests:n,typedData:o}=await cc(a,{address:c,authorizeKeys:j,chain:e,delegation:h}),p=bL({address:c,keys:d});return{capabilities:k,chainId:l,context:{...m,account:p},digests:n,typedData:o}}async function dj(a,b){let{phone:c,walletAddress:d}=b;return await cg(a,{phone:c,walletAddress:d})}async function dk(a,b){let{account:c=a.account,chain:d=a.chain,webAuthn:e}=b;if(!d)throw Error("`chain` is required.");let f=c?bL(c):void 0;if(!f)throw Error("`account` is required.");let g=b.key??bN(f,b);if(!g&&!f.sign)throw Error("`key` or `account` with `sign` is required");let h=await Promise.all((b.preCalls??[]).map(async c=>{if(c.signature)return c;let{authorizeKeys:g,key:h,calls:i,revokeKeys:j}=c,{context:k,digest:l}=await dh(a,{account:f,authorizeKeys:g,calls:i,chain:d,feeToken:b.feeToken,key:h,preCalls:!0,revokeKeys:j});return{context:k,signature:await bF(h,{address:null,payload:l,webAuthn:e})}})),{capabilities:i,context:j,digest:k}=await dh(a,{...b,account:f,chain:d,key:g,preCalls:h}),l=await (async()=>g?await bF(g,{address:null,payload:k,webAuthn:e,wrap:!1}):await f.sign({hash:k}))();return await dm(a,{capabilities:i.feeSignature?{feeSignature:i.feeSignature}:void 0,context:j,key:g,signature:l})}async function dl(a,b){let c=!!a.context.preCall,{account:d,key:e}=b;if(d){let b=d.keys?.findIndex(b=>b.publicKey===a.key?.publicKey);if(-1===b)throw Error("key not found");return await bO(d,{key:b,payload:a.digest,replaySafe:!1,wrap:c})}if(e)return await bF(e,{address:null,payload:a.digest,wrap:c});throw Error("no key or account provided")}async function dm(a,b){let{capabilities:c,context:d,key:e,signature:f}=b;return await cd(a,{capabilities:c,context:d,key:e?bG(e):void 0,signature:f})}async function dn(a,b){let{email:c,walletAddress:d}=b;return await ch(a,{email:c,walletAddress:d})}async function dp(a,b){let{phone:c,walletAddress:d}=b;return await ci(a,{phone:c,walletAddress:d})}async function dq(a,b){if(b.account){let{account:c}=b,d=[...c.keys??[],...b.authorizeKeys??[]].filter((a,b,c)=>c.findIndex(b=>b.id===a.id)===b),{digests:e,...f}=await di(a,{...b,address:c.address,authorizeKeys:d}),g={auth:await c.sign({hash:e.auth}),exec:await c.sign({hash:e.exec})};return await dq(a,{...f,signatures:g})}let{context:c,signatures:d}=b,e=bL(c.account);return await cj(a,{context:c,signatures:d}),e}async function dr(a,b){let{chainId:c,email:d,signature:e,token:f,walletAddress:g}=b;return await ck(a,{chainId:c,email:d,signature:e,token:f,walletAddress:g})}async function ds(a,b){let{code:c,phone:d,walletAddress:e}=b;return await cl(a,{code:c,phone:d,walletAddress:e})}function dt(a){return{createAccount:b=>dd(a,b),getCallsStatus:b=>b8(a,b),getCapabilities:()=>b5(a),getKeys:b=>de(a,b),health:()=>ca(a),prepareCalls:b=>dh(a,b),prepareUpgradeAccount:b=>di(a,b),sendCalls:b=>dk(a,b),sendPreparedCalls:b=>dm(a,b),upgradeAccount:b=>dq(a,b),verifySignature:b=>cn(a,b)}}a.i(387013),a.i(811196),a.i(510130),C.BaseError,a.s(["createAccount",()=>dd,"decorator",()=>dt,"getKeys",()=>de,"getOnrampContactInfo",()=>df,"onrampStatus",()=>dg,"prepareCalls",()=>dh,"prepareUpgradeAccount",()=>di,"resendVerifyPhone",()=>dj,"sendCalls",()=>dk,"sendPreparedCalls",()=>dm,"setEmail",()=>dn,"setPhone",()=>dp,"signCalls",()=>dl,"upgradeAccount",()=>dq,"verifyEmail",()=>dr,"verifyPhone",()=>ds],165729);var du=a.i(462697);async function dv(a,b){let{address:c}=b,{authorization:d,data:e,to:f}=await b4(a,{address:c});return du.wrap({authorization:{...d,nonce:BigInt(d.nonce),r:BigInt(d.r),s:BigInt(d.s)},data:e,signature:b.signature,to:f})}function dw(a,b){let{tokens:c}=b,d=c.filter(a=>a.interop);return a.map(a=>{if(a.address)return a;let b=d.find(b=>b.symbol===a.symbol);if(!b)throw Error(`interop token not found: ${a.symbol}`);return{address:b.address,value:a$(a.value,b.decimals)}})}async function dx(a,b){let{chain:c=a.chain}=b??{};return await b5(a,{chainId:c?.id}).then(a=>a.fees.tokens)}async function dy(a,b){let{addressOrSymbol:c}=b;return(await dx(a,b)).find(dy.predicate(c))}async function dz(a,b){let{chain:c=a.chain,store:d}=b??{},e=d?.getState()??{},f=b?.addressOrSymbol??e.feeToken,g=await dx(a,{chain:c}).then(a=>a.filter(a=>a.feeToken));return g?.find(a=>!!f&&(!!("native"===f&&a.address===be.zeroAddress||aw.validate(f)&&aw.isEqual(a.address,f))||f===a.symbol))}function dA(a={}){let b,c,{mock:d,multichain:e=!0,webAuthn:f}=a,g=(()=>{if("self"!==a.keystoreHost)return a.keystoreHost})();return cS({actions:{async addFunds(){throw new U},async createAccount(a){let{admins:c,email:e,label:h,permissions:i,internal:j,signInWithEthereum:k}=a,{client:l}=j,m=bM(aB.randomPrivateKey()),n=await dx(l),o=d?bs():await br({createFn:f?.createFn,label:h||`${m.address.slice(0,8)}\u2026${m.address.slice(-6)}`,rpId:g,userId:aE.from(m.address)}),p=await cX(i,{chainId:l.chain.id,feeTokens:n}),q=c?.map(a=>bv(a)),r=await dq(l,{account:m,authorizeKeys:[o,...q??[],...p?[p]:[]]});b=m.address,e&&h&&await dn(l,{email:h,walletAddress:r.address});let s=await (async()=>{if(!k)return;let a=await c7(l,k,{address:r.address}),b=await bO(m,{payload:da(ax.fromString(a))});return{message:a,signature:await dv(l,{address:r.address,signature:b})}})();return{account:{...r,signInWithEthereum:s}}},async getAccountVersion(a){let{address:b,internal:c}=a,{client:d}=c,{contracts:e}=await b5(d),{accountImplementation:f}=e,g=await dc(d,{account:bL(f)}).then(a=>a.version),h=await dc(d,{account:b}).then(a=>a.version).catch(()=>g);if(!h||!g)throw Error("version not found.");return{current:h,latest:g}},async getAssets(a){let{account:b,chainFilter:c,assetFilter:d,assetTypeFilter:e,internal:f}=a,{client:g}=f;return await b6(g,{account:b,assetFilter:d,assetTypeFilter:e,chainFilter:c})},async getCallsStatus(a){let{id:b,internal:c}=a,{client:d}=c,e=await b8(d,{id:b});return{atomic:!0,chainId:ax.fromNumber(d.chain.id),id:b,receipts:e.receipts?.map(a=>({blockHash:a.blockHash,blockNumber:ax.fromNumber(a.blockNumber),gasUsed:ax.fromNumber(a.gasUsed),logs:a.logs,status:a.status,transactionHash:a.transactionHash})),status:e.status,version:"1.0"}},async getCapabilities(a){let{chainIds:b,internal:c}=a,{client:d}=c,f={atomic:{status:"supported"},atomicBatch:{supported:!0},feeToken:{supported:!0,tokens:[]},merchant:{supported:!0},permissions:{supported:!0},requiredFunds:{supported:!!e,tokens:[]}};return Object.entries(await b5(d,{chainIds:b?b.map(a=>ax.toNumber(a)):"all",raw:!0})).reduce((a,[b,c])=>({...a,[b]:{...f,...c,feeToken:{supported:!0,tokens:c.fees.tokens},requiredFunds:{supported:!!e,tokens:e?c.fees.tokens.filter(a=>a.interop):[]}}}),{})},async getKeys(a){let{account:b,chainIds:c,internal:d}=a,{client:e}=d;return b1([...await de(e,{account:b,chainIds:c}),...b.keys??[]],a=>a.publicKey)},async grantAdmin(a){let{account:b,internal:c}=a,{client:d}=c,e=bv(a.key,{chainId:d.chain.id}),g=await dz(d,{addressOrSymbol:a.feeToken,store:c.store}),{id:h}=await dk(d,{account:b,authorizeKeys:[e],feeToken:g?.address,webAuthn:f});return await (0,cU.waitForCallsStatus)(d,{id:h,pollingInterval:500}),{key:e}},async grantPermissions(a){let{account:b,internal:c,permissions:d}=a,{client:e}=c,f=await dx(e),g=await cX(d,{chainId:e.chain.id,feeTokens:f});if(!g)throw Error("key to authorize not found.");let h=b.keys?.find(a=>"admin"===a.role&&a.privateKey);if(!h)throw Error("admin key not found.");let{context:i,digest:j}=await dh(e,{account:b,authorizeKeys:[g],key:h,preCalls:!0}),k=await bF(h,{address:null,payload:j});return await dm(e,{context:i,key:h,signature:k}),{key:g}},async loadAccounts(a){let{internal:c,permissions:e,signInWithEthereum:h}=a,{client:i}=c,j=await dx(i),k=await cX(e,{chainId:i.chain.id,feeTokens:j}),{digest:l,digestType:m,message:n}=await (async()=>{if(h&&a.address){let b=await c7(i,h,{address:a.address});return{context:void 0,digest:da(ax.fromString(b)),digestType:"siwe",message:b}}return{context:void 0,digest:"0x",message:void 0}})(),{address:o,credentialId:p,webAuthnSignature:q}=await (async()=>{if(d){if(!b)throw Error("address_internal not found.");return{address:b,credentialId:void 0}}if(a.address&&a.key)return{address:a.address,credentialId:a.key.credentialId};let c=await a9({challenge:l,getFn:f?.getFn,rpId:g}),e=c.raw.response;return{address:aE.toHex(new Uint8Array(e.userHandle)),credentialId:c.raw.id,webAuthnSignature:c}})(),r=await de(i,{account:o,chainIds:[i.chain.id]}),s=bL({address:o,keys:[...r,...k?[k]:[]].map((a,b)=>0===b&&"webauthn-p256"===a.type?bz({...a,credential:{id:p,publicKey:aV.fromHex(a.publicKey)},id:o,rpId:g}):a)}),t=bN(s,{role:"admin"}),u=await (async()=>{if("0x"!==l)return q?bK(bJ(q),{keyType:"webauthn-p256",publicKey:t.publicKey}):await bF(t,{address:s.address,payload:l})})();if(k){let{context:a,digest:b}=await dh(i,{account:s,authorizeKeys:[k],preCalls:!0}),c=await bF(t,{address:null,payload:b});await dm(i,{context:a,key:t,signature:c})}let v=await (async()=>{if(h){if("siwe"===m&&n&&u)return{message:n,signature:await dv(i,{address:s.address,signature:u})};{let a=await c7(i,h,{address:s.address}),b=await bO(s,{payload:da(ax.fromString(a)),role:"admin"});return{message:a,signature:await dv(i,{address:s.address,signature:b})}}}})();return{accounts:[{...s,signInWithEthereum:v}]}},async prepareCalls(a){let{account:b,calls:c,internal:d,merchantUrl:f}=a,{client:g}=d,h=a.key??await cT({account:b,calls:c});if(!h)throw Error("cannot find authorized key to sign with.");let[i,j]=await Promise.all([dx(g),dz(g,{addressOrSymbol:a.feeToken,store:d.store})]),k=dw(a.requiredFunds??[],{tokens:i}),{capabilities:l,context:m,digest:n,typedData:o}=await dh(g,{account:b,calls:c,feeToken:j?.address,key:h,merchantUrl:f,requiredFunds:e?k:void 0}),p=m.quote?.quotes??[],q=p[p.length-1];return{account:b,capabilities:{...l,quote:m.quote},chainId:g.chain.id,context:{...m,account:b,calls:c,nonce:q?.intent.nonce},digest:n,key:h,typedData:o}},async prepareUpgradeAccount(a){let{address:b,email:e,label:h,internal:i,permissions:j}=a,{client:k}=i,[l,m]=await Promise.all([dx(k),dz(k,{store:i.store})]),n=d?bs():await br({createFn:f?.createFn,label:h||`${b.slice(0,8)}\u2026${b.slice(-6)}`,rpId:g,userId:aE.from(b)}),o=await cX(j,{chainId:k.chain.id,feeTokens:l}),{context:p,digests:q}=await di(k,{address:b,authorizeKeys:[n,...o?[o]:[]],feeToken:m?.address});return e&&(c=h),{context:p,digests:q}},async revokeAdmin(a){let{account:b,id:c,internal:d}=a,{client:e}=d,g=b.keys?.find(a=>a.id===c);if(g){if("webauthn-p256"===g.type&&b.keys?.filter(a=>"webauthn-p256"===a.type).length===1)throw Error("revoke the only WebAuthn key left.");try{let c=await dz(e,{addressOrSymbol:a.feeToken,store:d.store}),{id:h}=await dk(e,{account:b,feeToken:c?.address,revokeKeys:[g],webAuthn:f});await (0,cU.waitForCallsStatus)(e,{id:h})}catch(a){if("Rpc.ExecutionError"===a.name&&a.abiError?.name==="KeyDoesNotExist")return;throw a}}},async revokePermissions(a){let{account:b,id:c,internal:d}=a,{client:e}=d,g=b.keys?.find(a=>a.id===c);if(g){if("admin"===g.role)throw Error("cannot revoke admins.");try{let c=await dz(e,{addressOrSymbol:a.feeToken,store:d.store}),{id:h}=await dk(e,{account:b,feeToken:c?.address,revokeKeys:[g],webAuthn:f});await (0,cU.waitForCallsStatus)(e,{id:h})}catch(a){if("Rpc.ExecutionError"===a.name&&a.abiError?.name==="KeyDoesNotExist")return;throw a}}},async sendCalls(a){let{account:b,asTxHash:c,calls:d,chainId:g,internal:h,merchantUrl:i}=a,{client:j}=h,k=await cT({account:b,calls:d,permissionsId:a.permissionsId}),[l,m]=await Promise.all([dx(j),dz(j,{addressOrSymbol:a.feeToken,store:h.store})]),n=dw(a.requiredFunds??[],{tokens:l}),o=await dk(j,{account:b,calls:d,feeToken:m?.address,key:k,merchantUrl:i,requiredFunds:e?n:void 0,webAuthn:f,...g?{chain:{id:g}}:{}});if(c){let{id:a,receipts:b,status:c}=await (0,cU.waitForCallsStatus)(j,{id:o.id,pollingInterval:500});if(!b?.[0]){if("success"===c)throw new _({message:"Call bundle with id: "+a+" not found."});throw new I({message:"Transaction failed under call bundle id: "+a+"."})}return{id:b[0].transactionHash}}return o},async sendPreparedCalls(a){let{context:b,key:c,internal:d,signature:e}=a,{client:f}=d,{id:g}=await dm(f,{context:b,key:c,signature:e});return g},async signPersonalMessage(a){let{account:b,data:c,internal:d}=a,{client:e}=d,g=b.keys?.find(a=>"admin"===a.role&&a.privateKey);if(!g)throw Error("cannot find admin key to sign with.");let h=await bO(b,{key:g,payload:da(c),webAuthn:f});return dv(e,{address:b.address,signature:h})},async signTypedData(a){let{account:b,internal:c}=a,{client:d}=c,e=b.keys?.find(a=>"admin"===a.role&&a.privateKey);if(!e)throw Error("cannot find admin key to sign with.");let g=A.parse(a.data),h=g.domain?.name==="Orchestrator",i=await bO(b,{key:e,payload:aJ(g),replaySafe:!h,webAuthn:f});return h?i:dv(d,{address:b.address,signature:i})},async upgradeAccount(a){let{account:b,context:d,internal:e,signatures:f}=a,{client:g}=e;return await dq(g,{context:d,signatures:f}),c&&await dn(g,{email:c,walletAddress:b.address}),{account:b}},async verifyEmail(a){let{account:b,chainId:c,email:d,token:e,internal:g,walletAddress:h}=a,{client:i}=g,j=b.keys?.find(a=>"admin"===a.role&&a.privateKey);if(!j)throw Error("cannot find admin key to sign with.");let k=await bO(b,{key:j,payload:aG.keccak256(ax.fromString(`${d}${e}`)),webAuthn:f});return await dr(i,{chainId:c,email:d,signature:k,token:e,walletAddress:h})}},config:a,name:"rpc"})}function dB(a={}){let{fallback:b=dA(),host:c=ai.prod,renderer:d=ak(),theme:e,themeController:f}=a,g=new Set,h=function(a={}){let b=a.id??0;return{prepare:a=>({...{id:b++,...a},jsonrpc:"2.0"}),get id(){return b}}}();function i(a){return ad({async request(b){let c=h.prepare(b);return a.setState(a=>{let b=a.accounts[0],d=b?.keys?.find(a=>"admin"===a.role&&"webauthn-p256"===a.type);return{...a,requestQueue:[...a.requestQueue,{account:b?{address:b.address,key:d?{credentialId:d?.credentialId,publicKey:d.publicKey}:void 0}:void 0,request:c,status:"pending"}]}}),new Promise((b,d)=>{let e=f=>{let h=f.find(a=>a.request.id===c.id);if(!h&&0===f.length){g.delete(e),d(new S);return}h&&("success"===h.status||"error"===h.status)&&(g.delete(e),"success"===h.status?b(h.result):d(ae(h.error)),a.setState(a=>({...a,requestQueue:a.requestQueue.filter(a=>a.request.id!==c.id)})))};g.add(e)})}},{schema:null})}return cS({actions:{async addFunds(a){let{internal:b}=a,{request:c,store:d}=b;if("wallet_addFunds"!==c.method)throw Error("Cannot add funds for method: "+c.method);let e=i(d);return await e.request(c)},async createAccount(a){let{internal:b}=a,{client:c,config:d,request:e,store:f}=b,{storage:g}=d,h=i(f);return{account:await (async()=>{if("wallet_connect"===e.method){let[{capabilities:a,chainIds:b}]=e._decoded.params??[{}],f=dD(a?.signInWithEthereum?.authUrl??d.authUrl,{storage:g}),i=e.params?.[0]?.capabilities?.signInWithEthereum,j=await cX(a?.grantPermissions,{chainId:c.chain.id}),k=j?aA.encode(cV,cW(j)):void 0,{accounts:l}=await h.request({...e,params:[{capabilities:{...e.params?.[0]?.capabilities,grantPermissions:k,signInWithEthereum:f||i?{...i,authUrl:f}:void 0},chainIds:b?.map(a=>ax.fromNumber(a))}]}),[m]=l;if(!m)throw Error("no account found.");let n=m.capabilities?.admins?.map(a=>bv(a,{chainId:c.chain.id})).filter(Boolean),o=m.capabilities?.permissions?.map(a=>{try{let b=cB(aA.decode(cz,a));if(b.id===j?.id)return{...b,...j,permissions:b.permissions};return b}catch{return}}).filter(Boolean),p=await (async()=>{if(!m.capabilities?.signInWithEthereum)return;let{message:a,signature:b}=m.capabilities.signInWithEthereum;if(!f)return{message:a,signature:b};let{token:c}=await c6({address:m.address,authUrl:f,message:a,publicKey:m.capabilities?.admins?.[0]?.publicKey,signature:b});return{message:a,signature:b,token:c}})();return{...bL({address:m.address,keys:[...n??[],...o??[]]}),signInWithEthereum:p}}throw Error(`Account creation not supported on method: ${e.method}`)})()}},async disconnect(a){let{internal:b}=a,{config:c}=b,{storage:d}=c,e=await d.getItem("porto.authUrl")||void 0,f=dD(c.authUrl??e,{storage:d});f&&await fetch(f.logout,{credentials:"include",method:"POST"}).catch(()=>{})},async getAccountVersion(a){let{internal:c}=a,{store:e,request:f}=c;if("wallet_getAccountVersion"!==f.method)throw Error("Cannot get version for method: "+f.method);if(!d.supportsHeadless)return b.actions.getAccountVersion(a);let g=i(e);return await g.request(f)},async getAssets(a){let{internal:c}=a,{store:e,request:f}=c;if("wallet_getAssets"!==f.method)throw Error("Cannot get assets for method: "+f.method);if(!d.supportsHeadless)return b.actions.getAssets(a);let g=i(e),h=await g.request(f);return aA.decode(cD.wallet_getAssets.Response,h)},async getCallsStatus(a){let{internal:c}=a,{store:e,request:f}=c;if("wallet_getCallsStatus"!==f.method)throw Error("Cannot get status for method: "+f.method);if(!d.supportsHeadless)return b.actions.getCallsStatus(a);let g=i(e);return await g.request(f)},async getCapabilities(a){let{internal:c}=a,{store:e,request:f}=c;if("wallet_getCapabilities"!==f.method)throw Error("Cannot get capabilities for method: "+f.method);if(!d.supportsHeadless)return b.actions.getCapabilities(a);let g=i(e);return await g.request(f)},async getKeys(a){let{account:c,chainIds:e,internal:f}=a,{store:g}=f,h=await (async()=>{if(!d.supportsHeadless)return b.actions.getKeys(a);let f=i(g),h=await f.request({method:"wallet_getKeys",params:[aA.encode(cD.wallet_getKeys.Parameters,{address:c.address,chainIds:e})]});return aA.decode(cD.wallet_getKeys.Response,h)})();return b1([...h,...c.keys??[]],a=>a.publicKey)},async grantAdmin(a){let{internal:b}=a,{request:c,store:d}=b;if("wallet_grantAdmin"!==c.method)throw Error("Cannot authorize admin for method: "+c.method);let[e]=c._decoded.params,f=bv(e.key);if(!f)throw Error("no key found.");let g=await dC(b,a),h=i(d);return await h.request({method:"wallet_grantAdmin",params:[{...c.params?.[0],capabilities:{...c.params?.[0]?.capabilities,feeToken:g}}]}),{key:f}},async grantPermissions(a){let{internal:b}=a,{client:c,request:d,store:e}=b;if("wallet_grantPermissions"!==d.method)throw Error("Cannot grant permissions for method: "+d.method);let[{address:f,...g}]=d._decoded.params,h=await cX(g,{chainId:c.chain.id});if(!h)throw Error("no key found.");let j=aA.encode(cV,cW(h)),k=i(e);return await k.request({method:"wallet_grantPermissions",params:[j]}),{key:h}},async loadAccounts(a){let{internal:b}=a,{client:c,config:d,store:e}=b,{storage:f}=d,g=i(e),h=b.request;if("wallet_connect"!==h.method&&"eth_requestAccounts"!==h.method)throw Error("Cannot load accounts for method: "+h.method);return{accounts:await (async()=>{let[a]=h._decoded.params??[],{capabilities:b}=a??{},e=dD(b?.signInWithEthereum?.authUrl??d.authUrl,{storage:f}),i=h.params?.[0]?.capabilities?.signInWithEthereum,j=await cX(b?.grantPermissions,{chainId:c.chain.id}),k=j?aA.encode(cV,cW(j)):void 0,{accounts:l}=await g.request({method:"wallet_connect",params:[{...h.params?.[0],capabilities:{...h.params?.[0]?.capabilities,grantPermissions:k,signInWithEthereum:e||i?{...i,authUrl:e}:void 0}}]});return Promise.all(l.map(async a=>{let b=a.capabilities?.admins?.map(a=>bv(a)).filter(Boolean),c=a.capabilities?.permissions?.map(a=>{try{let b=cB(aA.decode(cz,a));if(b.id===j?.id)return{...b,...j,permissions:b.permissions};return b}catch{return}}).filter(Boolean),d=await (async()=>{if(!a.capabilities?.signInWithEthereum)return;let{message:b,signature:c}=a.capabilities.signInWithEthereum;if(!e)return{message:b,signature:c};let{token:d}=await c6({address:a.address,authUrl:e,message:b,publicKey:a.capabilities?.admins?.[0]?.publicKey,signature:c});return{message:b,signature:c,token:d}})();return{...bL({address:a.address,keys:[...b??[],...c??[]]}),signInWithEthereum:d}}))})()}},async prepareCalls(a){let{account:c,internal:e}=a,{store:f,request:g}=e;if("wallet_prepareCalls"!==g.method)throw Error("Cannot prepare calls for method: "+g.method);if(!d.supportsHeadless)return b.actions.prepareCalls(a);let h=await dC(e,a),j=i(f),k=aA.decode(cD.wallet_prepareCalls.Response,await j.request({...g,params:[{...g.params?.[0],capabilities:{...g.params?.[0]?.capabilities,feeToken:h}}]}));return{account:c,chainId:Number(k.chainId),context:k.context,digest:k.digest,key:k.key,typedData:k.typedData}},async prepareUpgradeAccount(a){let{internal:c}=a,{client:e,store:f,request:g}=c;if("wallet_prepareUpgradeAccount"!==g.method)throw Error("Cannot prepare upgrade for method: "+g.method);if(!d.supportsHeadless)return b.actions.prepareUpgradeAccount(a);let[{capabilities:h}]=g._decoded.params??[{}],j=await cX(h?.grantPermissions,{chainId:e.chain.id}),k=j?aA.encode(cV,cW(j)):void 0,l=i(f),{context:m,digests:n}=await l.request({...g,params:[{...g.params?.[0],capabilities:{...g.params?.[0]?.capabilities,grantPermissions:k}}]}),o=m.account.keys?.map(a=>a.id===j?.id?{...a,...j}:a);return{context:{...m,account:{...m.account,keys:o}},digests:n}},async revokeAdmin(a){let{account:b,id:c,internal:d}=a,{store:e,request:f}=d;if("wallet_revokeAdmin"!==f.method)throw Error("Cannot revoke admin for method: "+f.method);let g=b.keys?.find(a=>a.id===c);if(!g)return;if("webauthn-p256"===g.type&&b.keys?.filter(a=>"webauthn-p256"===a.type).length===1)throw Error("revoke the only WebAuthn key left.");let h=await dC(d,a),j=i(e);return await j.request({...f,params:[{...f.params?.[0],capabilities:{...f.params?.[0]?.capabilities,feeToken:h}}]})},async revokePermissions(a){let{account:b,id:c,internal:d}=a,{store:e,request:f}=d;if("wallet_revokePermissions"!==f.method)throw Error("Cannot revoke permissions for method: "+f.method);let g=b.keys?.find(a=>a.id===c);if(!g)return;if("admin"===g.role)throw Error("cannot revoke permissions.");let h=i(e);return await h.request(f)},async sendCalls(a){let{account:c,asTxHash:e,calls:f,chainId:g,internal:h,merchantUrl:j,requiredFunds:k}=a,{client:l,store:m,request:n}=h,o=i(m),p=await dC(h,a),q=await cT({account:c,calls:f,permissionsId:a.permissionsId});if(q&&"session"===q.role){if(!d.supportsHeadless)return b.actions.sendCalls(a);try{let a=await o.request(aA.encode(cD.wallet_prepareCalls.Request,{method:"wallet_prepareCalls",params:[{calls:f,capabilities:{..."wallet_sendCalls"===n._decoded.method?n._decoded.params?.[0]?.capabilities:void 0,feeToken:p,merchantUrl:j,requiredFunds:k},chainId:g,from:c.address,key:q}]})),b=a.capabilities?.quote?.quotes??[];if(b.some((a,c)=>(c!==b.length-1||!(b.length>1))&&ax.toBigInt(a.feeTokenDeficit)>0n))throw Error("insufficient funds");let d=await bF(q,{address:null,payload:a.digest,wrap:!1}),h=(await o.request({method:"wallet_sendPreparedCalls",params:[{...a,signature:d}]}))[0];if(!h)throw Error("id not found");if(e){let{id:a,receipts:b,status:c}=await (0,cU.waitForCallsStatus)(l,{id:h.id,pollingInterval:500});if(!b?.[0]){if("success"===c)throw new _({message:"Call bundle with id: "+a+" not found."});throw new I({message:"Transaction failed under call bundle id: "+a+"."})}return{id:b[0].transactionHash}}return h}catch{}}if("eth_sendTransaction"===n.method)return{id:await o.request({...n,params:[{...n.params?.[0],capabilities:{feeToken:p,merchantUrl:j},...g?{chainId:ax.fromNumber(g)}:{}}]})};if("wallet_sendCalls"===n.method)return await o.request({method:"wallet_sendCalls",params:[{...n.params?.[0],capabilities:{...n.params?.[0]?.capabilities,feeToken:p,merchantUrl:j},...g?{chainId:ax.fromNumber(g)}:{}}]});throw Error("Cannot execute for method: "+n.method)},async sendPreparedCalls(a){let{internal:c}=a,{store:e,request:f}=c;if("wallet_sendPreparedCalls"!==f.method)throw Error("Cannot send prepared calls for method: "+f.method);if(!d.supportsHeadless)return b.actions.sendPreparedCalls(a);let g=i(e),h=await g.request(f),j=h[0]?.id;if(!j)throw Error("id not found");return j},async signPersonalMessage(a){let{internal:b}=a,{store:c,request:d}=b;if("personal_sign"!==d.method)throw Error("Cannot sign personal message for method: "+d.method);let e=i(c);return await e.request(d)},async signTypedData(a){let{internal:b}=a,{store:c,request:d}=b;if("eth_signTypedData_v4"!==d.method)throw Error("Cannot sign typed data for method: "+d.method);let e=i(c);return await e.request(d)},async switchChain(a){let{internal:b}=a,{store:c,request:e}=b;if("wallet_switchEthereumChain"!==e.method)throw Error("Cannot switch chain for method: "+e.method);if(!d.supportsHeadless)return;let f=i(c);return await f.request(e)},async upgradeAccount(a){let{account:b,internal:c}=a,{store:d,request:e}=c;if("wallet_upgradeAccount"!==e.method)throw Error("Cannot upgrade account for method: "+e.method);let f=i(d);return await f.request(e),{account:b}},async verifyEmail(a){let{internal:b}=a,{request:c,store:d}=b;if("account_verifyEmail"!==c.method)throw Error("Cannot verify email for method: "+c.method);let e=i(d);return await e.request(c)}},config:a,name:"dialog",setup(a){let{internal:b}=a,{store:h}=b,i=d.setup({host:c,internal:b,theme:e,themeController:f}),j=h.subscribe(a=>a.requestQueue,a=>{for(let b of g)b(a);let b=a.map(a=>"pending"===a.status?a:void 0).filter(Boolean);i.syncRequests(b).catch(()=>{}),0===b.length&&i.close()});return()=>{j(),i.destroy()}}})}async function dC(a,b){let{config:{feeToken:c}}=a,{feeToken:d}=b??{};return d??c}function dD(a,{storage:b}){if(!a)return;let c=c8(a,void 0);return c&&b.setItem("porto.authUrl",c),c}function dE(a={}){if(!ah())return a.fallback??cS({actions:dA().actions,name:"relay"});let{redirectUri:b,requestOptions:c,...d}=a;return cS({...dB({...d,renderer:am({redirectUri:b,requestOptions:c})}),name:"reactNative"})}(dy||(dy={})).predicate=function(a){return b=>!!a&&(aw.validate(a)?aw.isEqual(b.address,a):"native"===a?b.address===be.zeroAddress:a===b.symbol)},a.s([],81439);var dF=a.i(81439);a.s(["_internal_types",0,dF,"dialog",()=>dB,"from",()=>cS,"reactNative",()=>dE,"relay",()=>dA],748621);var dG=a.i(748621),dH=a.i(616389),dI=a.i(97937),dJ=a.i(926183);function dK(a){return a}function dL(...a){return{async getItem(b){let c=(await Promise.allSettled(a.map(a=>a.getItem(b)))).find(a=>"fulfilled"===a.status&&null!==a.value);return c?.status!=="fulfilled"||null===c.value?null:c.value},async removeItem(b){await Promise.allSettled(a.map(a=>a.removeItem(b)))},async setItem(b,c){await Promise.allSettled(a.map(a=>a.setItem(b,c)))},sizeLimit:Math.min(...a.map(a=>a.sizeLimit)),storages:a}}function dM(){let a="undefined"!=typeof indexedDB?(0,dJ.createStore)("porto","store"):void 0;return{async getItem(b){let c=await (0,dJ.get)(b,a);return null===c?null:c},async removeItem(b){await (0,dJ.del)(b,a)},async setItem(b,c){await (0,dJ.set)(b,b0(c),a)},sizeLimit:0x3200000}}function dN(){return{async getItem(a){let b=window.localStorage.getItem(a);if(null===b)return null;try{return A.parse(b)}catch{return null}},async removeItem(a){window.localStorage.removeItem(a)},async setItem(a,b){window.localStorage.setItem(a,A.stringify(b))},sizeLimit:5242880}}function dO(){return{async getItem(a){let b=document.cookie.split("; ").find(b=>b.startsWith(`${a}=`));if(!b)return null;try{return A.parse(b.substring(a.length+1))}catch{return null}},async removeItem(a){document.cookie=`${a}=;max-age=-1;path=/`},async setItem(a,b){document.cookie=`${a}=${A.stringify(b)};path=/;samesite=None;secure;max-age=31536000`},sizeLimit:4096}}function dP(){let a=new Map;return{getItem:b=>a.get(b)??null,removeItem(b){a.delete(b)},setItem(b,c){a.set(b,c)},sizeLimit:1/0}}a.s(["combine",()=>dL,"cookie",()=>dO,"from",()=>dK,"idb",()=>dM,"localStorage",()=>dN,"memory",()=>dP],700778);let dQ={announceProvider:!0,chains:v,mode:dA(),relay:(0,ct.http)(cv.prod.http),storage:dP(),storageKey:"porto.store"};function dR(a={}){let b=a.chains??dQ.chains,c=Object.fromEntries(b.map(b=>[b.id,a.transports?.[b.id]??(0,ct.http)()])),d={announceProvider:a.announceProvider??dQ.announceProvider,authUrl:a.authUrl,chains:b,feeToken:a.feeToken,merchantUrl:a.merchantUrl,mode:a.mode??dQ.mode,relay:a.relay??dQ.relay,storage:a.storage??dQ.storage,storageKey:a.storageKey??dQ.storageKey,transports:c},e=(0,dI.createStore)((0,dH.devtools)((0,dH.subscribeWithSelector)((0,dH.persist)(a=>({accounts:[],chainIds:d.chains.map(a=>a.id),feeToken:d.feeToken,requestQueue:[]}),{merge(a,b){let c=d.chains.find(b=>b.id===a.chainIds[0])?.id??d.chains[0].id,e=[c,...d.chains.map(a=>a.id).filter(a=>a!==c)];return{...b,...a,chainIds:e}},name:d.storageKey,partialize:a=>({accounts:a.accounts.map(a=>b0(a)),chainIds:a.chainIds}),storage:d.storage,version:5})))),f=d.mode,g={config:d,getMode:()=>f,id:b2(),setMode:a=>(i?.(),f=a,i=a.setup({internal:g})),store:e},h=cI(g),i=null!==f?f.setup({internal:g}):()=>{};return{_internal:g,config:d,destroy(){i(),h._internal.destroy()},provider:h}}a.s(["create",()=>dR,"defaultConfig",0,dQ],78080);var dS=a.i(78080),dT=a.i(501997),dU=a.i(700778);a.i(242463);var dV=a.i(141476);a.s(["fallback",()=>cs.fallback,"http",()=>ct.http,"relayProxy",()=>cw,"relayUrls",0,cv,"webSocket",()=>dV.webSocket],474406);var dW=a.i(474406),dX=a.i(987752),dY=a.i(188986);a.i(165729),a.s(["addFaucetFunds",()=>b7,"createAccount",()=>dd,"decorator",()=>dt,"getAssets",()=>b6,"getAuthorization",()=>b4,"getCallsStatus",()=>b8,"getCapabilities",()=>b5,"getKeys",()=>de,"getOnrampContactInfo",()=>df,"health",()=>ca,"onrampStatus",()=>dg,"prepareCalls",()=>dh,"prepareUpgradeAccount",()=>di,"resendVerifyPhone",()=>dj,"sendCalls",()=>dk,"sendPreparedCalls",()=>dm,"setEmail",()=>dn,"setPhone",()=>dp,"signCalls",()=>dl,"upgradeAccount",()=>dq,"verifyEmail",()=>dr,"verifyPhone",()=>ds,"verifySignature",()=>cn],700551);var dZ=a.i(700551);a.s(["Account",0,dX,"Chains",0,z,"Dialog",0,av,"Key",0,dY,"Messenger",0,cR,"Mode",0,dG,"Porto",0,dS,"RelayActions",0,dZ,"RpcSchema",0,dT,"Storage",0,dU,"Transport",0,dW,"from",()=>cI],253331)}];

//# sourceMappingURL=89298_porto_dist_index_169ff5c8.js.map